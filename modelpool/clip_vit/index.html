
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../nyuv2/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>CLIP-ViT Models - FusionBench</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/material_extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#clip-vit-models-for-open-vocabulary-image-classification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="FusionBench" class="md-header__button md-logo" aria-label="FusionBench" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FusionBench
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CLIP-ViT Models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/tanganke/fusion_bench" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../algorithms/" class="md-tabs__link">
          
  
  
    
  
  Algorithms

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Model Pool (Benchmark Models)

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../taskpool/" class="md-tabs__link">
          
  
  
    
  
  Task Pool (Evaluation)

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/docs/" class="md-tabs__link">
          
  
  
    
  
  Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="FusionBench" class="md-nav__button md-logo" aria-label="FusionBench" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FusionBench
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tanganke/fusion_bench" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../get_started/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Get Started
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Get Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../get_started/basic_examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Basic Examples
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            Basic Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../get_started/intermediate_examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Intermediate Examples
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            Intermediate Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../get_started/advanced_examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Advanced Examples
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Further Reading
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Further Reading
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction_to_model_fusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deep Model Fusion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/dummy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dummy Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Ensemble
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Model Ensemble
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/simple_ensemble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple Ensemble
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/weighted_ensemble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Weighted Ensemble
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/max-model_predictor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Max-Model Predictor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Merging
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Model Merging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/simple_averaging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple Averaging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/weighted_averaging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Weighted Averaging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/slerp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SLERP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/fisher_merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fisher Merging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/task_arithmetic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task Arithmetic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/ties_merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ties-Merging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/adamerging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AdaMerging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/regmean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RegMean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/regmean_plusplus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RegMean++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/concrete_subspace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concrete Subspace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/task_singular_vector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task Singular Vector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/isotropic_merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Isotropic Merging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/wudi_merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WUDI-Merging
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Mixing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Model Mixing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/depth_upscaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Depth Upscaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/moe_based_upscaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MoE-based Upscaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/moe_based_merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MoE-based Merging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/weight_ensembling_moe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Weight-Ensembling MoE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/pwe_moe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PWE MoE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/smile_upscaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SMILE Upscaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/model_recombination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Recombination
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Compression
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Model Compression
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6_1" >
        
          
          <label class="md-nav__link" for="__nav_2_6_1" id="__nav_2_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Task Vector Compression
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_1">
            <span class="md-nav__icon md-icon"></span>
            Task Vector Compression
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/bitdelta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BitDelta
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6_2" >
        
          
          <label class="md-nav__link" for="__nav_2_6_2" id="__nav_2_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Parameter Pruning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            Parameter Pruning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/pruning/magnitude_pruning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Magnitude Pruning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Model Pool (Benchmark Models)
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Model Pool (Benchmark Models)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    CLIP-ViT Models
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    CLIP-ViT Models
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#classification-head-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Classification Head Initialization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-eight-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      The Eight Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Eight Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#direct-model-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Direct Model Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-clipvisionmodelpool" class="md-nav__link">
    <span class="md-ellipsis">
      Using CLIPVisionModelPool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-of-the-fine-tuned-models" class="md-nav__link">
    <span class="md-ellipsis">
      Performance of the Fine-tuned Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-20-task-model-collections" class="md-nav__link">
    <span class="md-ellipsis">
      The 20-Task Model Collections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clipvisionmodelpool-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      CLIPVisionModelPool Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLIPVisionModelPool Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Class Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-pool-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Model Pool Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Pool Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#special-model-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Special Model Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-usage-example" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-configuration-example" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Configuration Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-modelscope-platform" class="md-nav__link">
    <span class="md-ellipsis">
      Working with ModelScope Platform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lora-and-l-lora-models" class="md-nav__link">
    <span class="md-ellipsis">
      LoRA and L-LoRA Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoRA and L-LoRA Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#training-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Training Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-model-collections" class="md-nav__link">
    <span class="md-ellipsis">
      Available Model Collections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-lora-models" class="md-nav__link">
    <span class="md-ellipsis">
      Loading LoRA Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-l-lora-models" class="md-nav__link">
    <span class="md-ellipsis">
      Loading L-LoRA Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-with-clipvisionmodelpool" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with CLIPVisionModelPool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-information-inspection" class="md-nav__link">
    <span class="md-ellipsis">
      Model Information Inspection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Information Inspection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#programmatic-model-information" class="md-nav__link">
    <span class="md-ellipsis">
      Programmatic Model Information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-model-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Single Model Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-averaging" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Averaging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fisher-merging" class="md-nav__link">
    <span class="md-ellipsis">
      Fisher Merging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regmean" class="md-nav__link">
    <span class="md-ellipsis">
      RegMean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regmean_1" class="md-nav__link">
    <span class="md-ellipsis">
      RegMean++
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Task Arithmetic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties-merging" class="md-nav__link">
    <span class="md-ellipsis">
      Ties-Merging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adamerging" class="md-nav__link">
    <span class="md-ellipsis">
      AdaMerging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weight-ensembling-moe" class="md-nav__link">
    <span class="md-ellipsis">
      Weight-Ensembling MoE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#experimental-results" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scope" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-vector-cosine-similarity" class="md-nav__link">
    <span class="md-ellipsis">
      Task Vector Cosine Similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generalization-and-robustness-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Generalization and Robustness Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#experimental-results_1" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-configuration-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Model Configuration Schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#platform-support" class="md-nav__link">
    <span class="md-ellipsis">
      Platform Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nyuv2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ResNet Models for Sence Understanding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gpt2_classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GPT-2 Models for Text Classification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flan-t5_generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flan-T5 Models for Text Generation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../llm/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Large Language Models
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Large Language Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/llama-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLaMA-2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/llama-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLaMA-3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/Qwen2.5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen2.5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/gemma-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gemma-2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../taskpool/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Task Pool (Evaluation)
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Task Pool (Evaluation)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../taskpool/dummy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dummy TaskPool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Task Pool for Llama Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Task Pool for Llama Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../taskpool/LlamaTestGenerationTaskPool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LlamaTestGenerationTaskPool
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../taskpool/clip_vit_classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classification Tasks for CLIP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../taskpool/gpt2_classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GPT-2 Sequence Classification Tasks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../taskpool/flan-t5_generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flan-T5 Models for Text Generation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Large Language Model
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Large Language Model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../taskpool/lm_eval_harness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task Pool for Language Model Evaluation Harness
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../taskpool/lm_eval_harness_cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LM Evaluation Harness CLI Tool
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.mixins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.mixins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.program/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.program
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api/fusion_bench.method/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    fusion_bench.method
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            fusion_bench.method
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.method/ensemble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Ensemble
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.method/merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Merging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.method/mixing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Mixing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.method/compression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Compression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.method/training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Training/Fine-Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.method/utility/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utility Classes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.modelpool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.modelpool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.taskpool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.taskpool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api/fusion_bench.utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    fusion_bench.utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            fusion_bench.utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Profiling Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/caching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Caching Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/torch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PyTorch Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/filesystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FileSystem Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/modelscope/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ModelScope Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.utils/package_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Package Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.dataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.tasks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.optim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.optim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fusion_bench.compat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench.compat
    
  </span>
  
    
  
  
    <span class="md-status md-status--deprecated" title="Deprecated">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📚 Documentation
    
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recently added">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../guides/fusion_bench/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    FusionBench Programming Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            FusionBench Programming Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2_2" id="__nav_6_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Mixins
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_2">
            <span class="md-nav__icon md-icon"></span>
            Mixins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/fusion_bench/mixins/lightning_fabric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LightningFabricMixin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/fusion_bench/mixins/simple_profiler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SimpleProfilerMixin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/fusion_bench/mixins/pyinstrument_profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PyinstrumentProfilerMixin
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CLIP-ViT Models For Image Classification
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            CLIP-ViT Models For Image Classification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/clip_vit/HFCLIPClassifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image Classification with CLIP Models using HFCLIPClassifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/clip_vit/classification_templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manage Labels and Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/clip_vit/finetune/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fine-Tune Your Own Vision Transformer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ResNet Models For Image Classification
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            ResNet Models For Image Classification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/resnet/image_classification_finetune/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fine-tuning ResNet Models for Image Classification
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Natural Language Processing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Natural Language Processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_5_1" >
        
          
          <label class="md-nav__link" for="__nav_6_5_1" id="__nav_6_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_1">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/nlp/question_answering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Question Answering
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_6" >
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CLI Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            CLI Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/fusion_bench/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fusion_bench: The Command Line Interface for FusionBench
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/fusion_bench_webui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command Generator WebUI
    
  </span>
  
    
  
  
    <span class="md-status md-status--deprecated" title="Deprecated">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#classification-head-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Classification Head Initialization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-eight-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      The Eight Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Eight Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#direct-model-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Direct Model Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-clipvisionmodelpool" class="md-nav__link">
    <span class="md-ellipsis">
      Using CLIPVisionModelPool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-of-the-fine-tuned-models" class="md-nav__link">
    <span class="md-ellipsis">
      Performance of the Fine-tuned Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-20-task-model-collections" class="md-nav__link">
    <span class="md-ellipsis">
      The 20-Task Model Collections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clipvisionmodelpool-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      CLIPVisionModelPool Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLIPVisionModelPool Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Class Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-pool-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Model Pool Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Pool Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#special-model-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Special Model Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-usage-example" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-configuration-example" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Configuration Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-modelscope-platform" class="md-nav__link">
    <span class="md-ellipsis">
      Working with ModelScope Platform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lora-and-l-lora-models" class="md-nav__link">
    <span class="md-ellipsis">
      LoRA and L-LoRA Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoRA and L-LoRA Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#training-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Training Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-model-collections" class="md-nav__link">
    <span class="md-ellipsis">
      Available Model Collections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-lora-models" class="md-nav__link">
    <span class="md-ellipsis">
      Loading LoRA Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-l-lora-models" class="md-nav__link">
    <span class="md-ellipsis">
      Loading L-LoRA Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-with-clipvisionmodelpool" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with CLIPVisionModelPool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-information-inspection" class="md-nav__link">
    <span class="md-ellipsis">
      Model Information Inspection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Information Inspection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#programmatic-model-information" class="md-nav__link">
    <span class="md-ellipsis">
      Programmatic Model Information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-model-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Single Model Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-averaging" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Averaging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fisher-merging" class="md-nav__link">
    <span class="md-ellipsis">
      Fisher Merging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regmean" class="md-nav__link">
    <span class="md-ellipsis">
      RegMean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regmean_1" class="md-nav__link">
    <span class="md-ellipsis">
      RegMean++
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Task Arithmetic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties-merging" class="md-nav__link">
    <span class="md-ellipsis">
      Ties-Merging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adamerging" class="md-nav__link">
    <span class="md-ellipsis">
      AdaMerging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weight-ensembling-moe" class="md-nav__link">
    <span class="md-ellipsis">
      Weight-Ensembling MoE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#experimental-results" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scope" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-vector-cosine-similarity" class="md-nav__link">
    <span class="md-ellipsis">
      Task Vector Cosine Similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generalization-and-robustness-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Generalization and Robustness Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#experimental-results_1" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-configuration-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Model Configuration Schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#platform-support" class="md-nav__link">
    <span class="md-ellipsis">
      Platform Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/tanganke/fusion_bench/blob/main/docs/modelpool/clip_vit.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/tanganke/fusion_bench/raw/main/docs/modelpool/clip_vit.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="clip-vit-models-for-open-vocabulary-image-classification">CLIP-ViT Models for Open Vocabulary Image Classification<a class="headerlink" href="#clip-vit-models-for-open-vocabulary-image-classification" title="Permanent link">&para;</a></h1>
<p>This document provides comprehensive information about CLIP-ViT models for open vocabulary image classification, including model implementation details, usage instructions, and experimental results. The <code>CLIPVisionModelPool</code> class manages collections of pre-trained and fine-tuned CLIP Vision models for open vocabulary image classification tasks.</p>
<h2 id="classification-head-initialization">Classification Head Initialization<a class="headerlink" href="#classification-head-initialization" title="Permanent link">&para;</a></h2>
<p>FusionBench employs CLIP's zero-shot classification approach. The classification head is constructed by:</p>
<ol>
<li>Generating text embeddings for each class name using predefined templates (e.g., "a photo of a {class}")</li>
<li>Computing text embeddings using CLIP's text encoder for all class-template combinations</li>
<li>Averaging embeddings across templates to obtain final class representations</li>
<li>These text embeddings serve as the classification weights</li>
</ol>
<p>Implementation details can be found at <a class="autorefs autorefs-internal" title="            setup_zero_shot_classification_head(clip_processor=None, clip_model=None, task_names=None)" href="../../api/fusion_bench.mixins/#fusion_bench.mixins.CLIPClassificationMixin.setup_zero_shot_classification_head"><code>CLIPClassificationMixin.setup_zero_shot_classification_head</code></a>.</p>
<h2 id="the-eight-tasks">The Eight Tasks<a class="headerlink" href="#the-eight-tasks" title="Permanent link">&para;</a></h2>
<p>The most common eight tasks used in the research community are SUN397, Cars, RESISC45, EuroSAT, SVHN, GTSRB, MNIST, and DTD.
These tasks cover a wide range of domains, including natural images, satellite images, and digit recognition.
You can download the datasets from <a href="https://huggingface.co/collections/tanganke/the-eight-image-classification-tasks-6644ce0376c0a469f6928507">this HuggingFace Collection</a> or using the <code>datasets</code> library as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># take `gtsrb` as an example</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;tanganke/gtsrb&quot;</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">test_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span>
</span></code></pre></div>
<p>The authors of Task Arithmetic have fine-tuned the CLIP-ViT models from the <em>open_clip</em> library on these eight tasks and provide the models publicly on <a href="https://drive.google.com/drive/folders/1u_Tva6x0p6oxu5Eo0ZZsf-520Cc_3MKw?usp=share_link">Google Drive</a>. 
However, these models rely on a specific version of the <em>open_clip</em> library. </p>
<p>To make experiments more convenient and avoid dependency on a specific library version, we have re-trained these models and made them publicly available on the HuggingFace Model Hub.
We use the Adam Optimizer with a fixed learning rate of 1e-5 over 4000 training steps (batch_size=32).
Only the vision encoder is fine-tuned, while the text encoder remains fixed to preserve the open-vocabulary property of the model.</p>
<ul>
<li><a href="https://huggingface.co/collections/tanganke/clip-vit-b-32-on-the-eight-image-classication-tasks-6644d0c476c0a469f693cf91">fine-tuned CLIP-ViT-B/32 models</a></li>
<li><a href="https://huggingface.co/collections/tanganke/clip-vit-b-16-on-the-eight-image-classification-tasks-66cd54d8332ce5c7468ab5f8">fine-tuned CLIP-ViT-B/16 models</a></li>
<li><a href="https://huggingface.co/collections/tanganke/clip-vit-l-14-on-the-eight-image-classification-tasks-6644d2b014331c746683de63">fine-tuned CLIP-ViT-L/14 models</a></li>
</ul>
<p>To use these models, you can load them from the Transformers library as follows:</p>
<h3 id="direct-model-usage">Direct Model Usage<a class="headerlink" href="#direct-model-usage" title="Permanent link">&para;</a></h3>
<p>Load vision backbone directly:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPVisionModel</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># load the CLIP-ViT-B/32 model, take `gtsrb` as an example</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">vision_model</span> <span class="o">=</span> <span class="n">CLIPVisionModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;tanganke/clip-vit-base-patch32_gtsrb&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>Substitute the vision encoder of CLIP:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPProcessor</span><span class="p">,</span> <span class="n">CLIPModel</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1"># load pre-trained CLIP model</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">clip_model</span> <span class="o">=</span> <span class="n">CLIPModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span><span class="p">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1"># substitute the vision model with the fine-tuned one</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">clip_model</span><span class="o">.</span><span class="n">vision_model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">vision_model</span><span class="o">.</span><span class="n">vision_model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span></code></pre></div>
<h3 id="using-clipvisionmodelpool">Using <code>CLIPVisionModelPool</code><a class="headerlink" href="#using-clipvisionmodelpool" title="Permanent link">&para;</a></h3>
<p>For more convenient model management, use the CLIPVisionModelPool:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fusion_bench.modelpool</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPVisionModelPool</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">omegaconf</span><span class="w"> </span><span class="kn">import</span> <span class="n">DictConfig</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># Initialize model pool</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">models</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>        <span class="s2">&quot;_pretrained_&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span><span class="p">,</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>        <span class="s2">&quot;gtsrb&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/clip-vit-base-patch32_gtsrb&quot;</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="p">},</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="n">processor</span><span class="o">=</span><span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="p">)</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c1"># Load models through the pool</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="n">vision_model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;gtsrb&quot;</span><span class="p">)</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="n">processor</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_processor</span><span class="p">()</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c1"># Or load complete CLIP model</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="n">clip_model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_clip_model</span><span class="p">(</span><span class="s2">&quot;_pretrained_&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>The <code>CLIPVisionModelPool</code> class provides a convenient way to manage multiple CLIP Vision models, and the models are automatically downloaded from the Hugging Face Model Hub when needed.
Alternatively, you can configure a model pool to automatically download models from ModelScope. This is useful if you prefer to use the ModelScope platform, which is popular in China and provides access to a wide range of models.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fusion_bench.modelpool</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPVisionModelPool</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">omegaconf</span><span class="w"> </span><span class="kn">import</span> <span class="n">DictConfig</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># Initialize model pool</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">models</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>        <span class="s2">&quot;_pretrained_&quot;</span><span class="p">:</span> <span class="s2">&quot;openai-mirror/clip-vit-base-patch32&quot;</span><span class="p">,</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="s2">&quot;gtsrb&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/clip-vit-base-patch32_gtsrb&quot;</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="p">},</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="n">processor</span><span class="o">=</span><span class="s2">&quot;openai-mirror/clip-vit-base-patch32&quot;</span><span class="p">,</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="n">platform</span><span class="o">=</span><span class="s2">&quot;modelscope&quot;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="p">)</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="c1"># Load models through the pool</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="n">vision_model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;gtsrb&quot;</span><span class="p">)</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="n">processor</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_processor</span><span class="p">()</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="c1"># Or load complete CLIP model</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="n">clip_model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_clip_model</span><span class="p">(</span><span class="s2">&quot;gtsrb&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="performance-of-the-fine-tuned-models">Performance of the Fine-tuned Models<a class="headerlink" href="#performance-of-the-fine-tuned-models" title="Permanent link">&para;</a></h3>
<p>evaluate the fine-tuned CLIP-ViT-B/32 models on the eight tasks:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># evaluate singlue fine-tuned models</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">for</span><span class="w"> </span>task<span class="w"> </span><span class="k">in</span><span class="w"> </span>sun397<span class="w"> </span>stanford-cars<span class="w"> </span>resisc45<span class="w"> </span>eurosat<span class="w"> </span>svhn<span class="w"> </span>gtsrb<span class="w"> </span>mnist<span class="w"> </span>dtd
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">do</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>dummy<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">        </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_individual<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">            </span>modelpool.models._pretrained_.pretrained_model_name_or_path<span class="o">=</span>tanganke/clip-vit-base-patch32_<span class="si">${</span><span class="nv">task</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">        </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">        </span><span class="nv">report_save_path</span><span class="o">=</span><span class="s2">&quot;outputs/ViT-B-32/single-task/clip-vit-base-patch32_</span><span class="si">${</span><span class="nv">task</span><span class="si">}</span><span class="s2">.json&quot;</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="k">done</span>
</span></code></pre></div>
<p>evaluate the fine-tuned CLIP-ViT-L/14 models on the eight tasks:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># assume you have eight GPUs, and you can evaluate the models on the eight tasks in parallel</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nv">tasks</span><span class="o">=(</span>sun397<span class="w"> </span>stanford-cars<span class="w"> </span>resisc45<span class="w"> </span>eurosat<span class="w"> </span>svhn<span class="w"> </span>gtsrb<span class="w"> </span>mnist<span class="w"> </span>dtd<span class="o">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nv">CUDA_DEVICES</span><span class="o">=(</span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="o">)</span><span class="w">  </span><span class="c1"># List of CUDA devices to use</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!CUDA_DEVICES[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="nv">task</span><span class="o">=</span><span class="si">${</span><span class="nv">tasks</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="si">${</span><span class="nv">CUDA_DEVICES</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="w"> </span>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>dummy<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">        </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_individual<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">            </span>modelpool.models._pretrained_.pretrained_model_name_or_path<span class="o">=</span>tanganke/clip-vit-large-patch14_<span class="si">${</span><span class="nv">task</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">        </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">            </span>taskpool.clip_model<span class="o">=</span>openai/clip-vit-large-patch14<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">        </span><span class="nv">report_save_path</span><span class="o">=</span><span class="s2">&quot;outputs/ViT-L-14/single-task/clip-vit-large-patch14_</span><span class="si">${</span><span class="nv">task</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="w"> </span><span class="p">&amp;</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="k">done</span>
</span></code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Performance of the fine-tuned CLIP-ViT-B/32 models</label><label for="__tabbed_1_2">Performance of the fine-tuned CLIP-ViT-B/16 models</label><label for="__tabbed_1_3">Performance of the fine-tuned CLIP-ViT-L/14 models</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Model</th>
<th>SUN397</th>
<th>Cars</th>
<th>RESISC45</th>
<th>EuroSAT</th>
<th>SVHN</th>
<th>GTSRB</th>
<th>MNIST</th>
<th>DTD</th>
<th>Average</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pre-trained</td>
<td>63.2</td>
<td>59.8</td>
<td>60.7</td>
<td>46.0</td>
<td>31.6</td>
<td>32.5</td>
<td>48.3</td>
<td>43.9</td>
<td>48.2</td>
</tr>
<tr>
<td>SUN397</td>
<td><strong>75.0</strong></td>
<td>47.0</td>
<td>54.3</td>
<td>46.5</td>
<td>28.3</td>
<td>26.4</td>
<td>44.3</td>
<td>41.6</td>
<td>45.4</td>
</tr>
<tr>
<td>Cars</td>
<td>56.6</td>
<td><strong>78.3</strong></td>
<td>50.9</td>
<td>38.4</td>
<td>30.2</td>
<td>30.6</td>
<td>49.7</td>
<td>41.8</td>
<td>47.1</td>
</tr>
<tr>
<td>RESISC45</td>
<td>52.0</td>
<td>47.2</td>
<td><strong>95.2</strong></td>
<td>56.9</td>
<td>23.9</td>
<td>24.3</td>
<td>39.7</td>
<td>35.9</td>
<td>46.9</td>
</tr>
<tr>
<td>EuroSAT</td>
<td>49.0</td>
<td>39.9</td>
<td>33.5</td>
<td><strong>99.0</strong></td>
<td>11.8</td>
<td>22.9</td>
<td>33.8</td>
<td>35.5</td>
<td>40.7</td>
</tr>
<tr>
<td>SVHN</td>
<td>40.5</td>
<td>36.3</td>
<td>18.9</td>
<td>9.8</td>
<td><strong>97.3</strong></td>
<td>27.3</td>
<td>81.8</td>
<td>23.2</td>
<td>41.9</td>
</tr>
<tr>
<td>GTSRB</td>
<td>36.8</td>
<td>33.0</td>
<td>20.6</td>
<td>21.3</td>
<td>41.2</td>
<td><strong>98.9</strong></td>
<td>30.9</td>
<td>23.9</td>
<td>38.3</td>
</tr>
<tr>
<td>MNIST</td>
<td>50.3</td>
<td>40.0</td>
<td>31.3</td>
<td>17.7</td>
<td>50.1</td>
<td>19.3</td>
<td><strong>99.6</strong></td>
<td>30.7</td>
<td>42.4</td>
</tr>
<tr>
<td>DTD</td>
<td>54.6</td>
<td>51.3</td>
<td>36.9</td>
<td>25.0</td>
<td>28.9</td>
<td>21.8</td>
<td>47.3</td>
<td><strong>79.7</strong></td>
<td>43.2</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Model</th>
<th>SUN397</th>
<th>Cars</th>
<th>RESISC45</th>
<th>EuroSAT</th>
<th>SVHN</th>
<th>GTSRB</th>
<th>MNIST</th>
<th>DTD</th>
<th>Average</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUN397</td>
<td><strong>78.9</strong></td>
<td>56.2</td>
<td>58.9</td>
<td>46.6</td>
<td>42.7</td>
<td>39.9</td>
<td>59.3</td>
<td>40.8</td>
<td>52.9</td>
</tr>
<tr>
<td>Cars</td>
<td>62.2</td>
<td><strong>85.9</strong></td>
<td>60.8</td>
<td>48.7</td>
<td>47.1</td>
<td>44.8</td>
<td>61.6</td>
<td>43.2</td>
<td>56.8</td>
</tr>
<tr>
<td>RESISC45</td>
<td>60.5</td>
<td>57.8</td>
<td><strong>96.6</strong></td>
<td>65.7</td>
<td>28.4</td>
<td>35.6</td>
<td>71.5</td>
<td>39.0</td>
<td>56.9</td>
</tr>
<tr>
<td>EuroSAT</td>
<td>58.3</td>
<td>59.2</td>
<td>37.4</td>
<td><strong>99.0</strong></td>
<td>40.5</td>
<td>38.9</td>
<td>57.4</td>
<td>37.7</td>
<td>53.6</td>
</tr>
<tr>
<td>SVHN</td>
<td>57.6</td>
<td>55.4</td>
<td>42.8</td>
<td>19.6</td>
<td><strong>97.6</strong></td>
<td>32.6</td>
<td>90.0</td>
<td>33.1</td>
<td>53.6</td>
</tr>
<tr>
<td>GTSRB</td>
<td>54.0</td>
<td>50.5</td>
<td>25.3</td>
<td>13.2</td>
<td>52.0</td>
<td><strong>99.0</strong></td>
<td>56.9</td>
<td>33.9</td>
<td>48.1</td>
</tr>
<tr>
<td>MNIST</td>
<td>58.7</td>
<td>52.4</td>
<td>47.0</td>
<td>23.6</td>
<td>65.0</td>
<td>27.6</td>
<td><strong>99.7</strong></td>
<td>37.7</td>
<td>51.5</td>
</tr>
<tr>
<td>DTD</td>
<td>57.7</td>
<td>58.1</td>
<td>53.5</td>
<td>43.0</td>
<td>44.2</td>
<td>36.2</td>
<td>70.4</td>
<td><strong>82.3</strong></td>
<td>55.7</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Model</th>
<th>SUN397</th>
<th>Cars</th>
<th>RESISC45</th>
<th>EuroSAT</th>
<th>SVHN</th>
<th>GTSRB</th>
<th>MNIST</th>
<th>DTD</th>
<th>Average</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pre-trained</td>
<td>68.3</td>
<td>77.8</td>
<td>71.0</td>
<td>58.9</td>
<td>58.4</td>
<td>50.6</td>
<td>76.4</td>
<td>55.5</td>
<td>64.6</td>
</tr>
<tr>
<td>SUN397</td>
<td><strong>82.8</strong></td>
<td>68.4</td>
<td>58.1</td>
<td>49.9</td>
<td>55.0</td>
<td>46.3</td>
<td>79.5</td>
<td>52.8</td>
<td>61.6</td>
</tr>
<tr>
<td>Cars</td>
<td>67.8</td>
<td><strong>92.9</strong></td>
<td>68.7</td>
<td>56.4</td>
<td>51.7</td>
<td>47.7</td>
<td>80.5</td>
<td>55.6</td>
<td>65.2</td>
</tr>
<tr>
<td>RESISC45</td>
<td>65.6</td>
<td>69.0</td>
<td><strong>97.4</strong></td>
<td>64.3</td>
<td>38.3</td>
<td>46.6</td>
<td>77.7</td>
<td>49.9</td>
<td>63.6</td>
</tr>
<tr>
<td>EuroSAT</td>
<td>65.2</td>
<td>69.0</td>
<td>40.6</td>
<td><strong>99.2</strong></td>
<td>33.4</td>
<td>45.6</td>
<td>73.5</td>
<td>47.1</td>
<td>59.2</td>
</tr>
<tr>
<td>SVHN</td>
<td>66.4</td>
<td>69.0</td>
<td>54.0</td>
<td>19.7</td>
<td><strong>97.9</strong></td>
<td>48.7</td>
<td>92.2</td>
<td>50.1</td>
<td>62.3</td>
</tr>
<tr>
<td>GTSRB</td>
<td>63.4</td>
<td>64.8</td>
<td>38.7</td>
<td>19.6</td>
<td>71.0</td>
<td><strong>99.2</strong></td>
<td>75.1</td>
<td>45.8</td>
<td>59.7</td>
</tr>
<tr>
<td>MNIST</td>
<td>56.0</td>
<td>49.8</td>
<td>53.5</td>
<td>26.6</td>
<td>48.2</td>
<td>33.1</td>
<td><strong>99.8</strong></td>
<td>47.1</td>
<td>51.7</td>
</tr>
<tr>
<td>DTD</td>
<td>66.8</td>
<td>75.3</td>
<td>65.5</td>
<td>43.7</td>
<td>49.5</td>
<td>45.0</td>
<td>68.5</td>
<td><strong>85.5</strong></td>
<td>62.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h2 id="the-20-task-model-collections">The 20-Task Model Collections<a class="headerlink" href="#the-20-task-model-collections" title="Permanent link">&para;</a></h2>
<p>In addition to the eight tasks, we have also fine-tuned CLIP-ViT-B/32 models on 12 additional image classification tasks, resulting in a total of 20 tasks. These additional tasks include:</p>
<ul>
<li><a href="https://huggingface.co/datasets/dpdl-benchmark/oxford_flowers102">oxford_flowers102</a>: Oxford 102 Flower dataset with 102 flower categories</li>
<li><a href="https://huggingface.co/datasets/1aurent/PatchCamelyon">pcam</a>: PatchCamelyon dataset for histopathologic cancer detection</li>
<li><a href="https://huggingface.co/datasets/clip-benchmark/wds_fer2013">fer2013</a>: Facial Expression Recognition 2013 dataset</li>
<li><a href="https://huggingface.co/datasets/timm/oxford-iiit-pet">oxford-iiit-pet</a>: Oxford-IIIT Pet dataset with 37 pet breeds</li>
<li><a href="https://huggingface.co/datasets/tanganke/stl10">stl10</a>: STL-10 dataset with 10 classes</li>
<li><a href="https://huggingface.co/datasets/tanganke/cifar100">cifar100</a>: CIFAR-100 dataset with 100 fine-grained classes</li>
<li><a href="https://huggingface.co/datasets/tanganke/cifar10">cifar10</a>: CIFAR-10 dataset with 10 classes</li>
<li><a href="https://huggingface.co/datasets/ethz/food101">food101</a>: Food-101 dataset with 101 food categories</li>
<li><a href="https://huggingface.co/datasets/zalando-datasets/fashion_mnist">fashion_mnist</a>: Fashion-MNIST dataset with 10 fashion categories</li>
<li><a href="https://huggingface.co/datasets/tanganke/emnist_letters">emnist_letters</a>: EMNIST Letters dataset</li>
<li><a href="https://huggingface.co/datasets/tanganke/kmnist">kmnist</a>: Kuzushiji-MNIST dataset</li>
<li><a href="https://huggingface.co/datasets/nateraw/rendered-sst2">rendered-sst2</a>: Rendered Stanford Sentiment Treebank v2 dataset</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Performance of the fine-tuned CLIP-ViT-B/32 models</label><label for="__tabbed_2_2">Performance of the fine-tuned CLIP-ViT-B/16 models</label><label for="__tabbed_2_3">Performance of the fine-tuned CLIP-ViT-L/14 models</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th style="text-align: left;">Models</th>
<th style="text-align: right;">sun397</th>
<th style="text-align: right;">stanford-cars</th>
<th style="text-align: right;">resisc45</th>
<th style="text-align: right;">eurosat</th>
<th style="text-align: right;">svhn</th>
<th style="text-align: right;">gtsrb</th>
<th style="text-align: right;">mnist</th>
<th style="text-align: right;">dtd</th>
<th style="text-align: right;">oxford_flowers102</th>
<th style="text-align: right;">pcam</th>
<th style="text-align: right;">fer2013</th>
<th style="text-align: right;">oxford-iiit-pet</th>
<th style="text-align: right;">stl10</th>
<th style="text-align: right;">cifar100</th>
<th style="text-align: right;">cifar10</th>
<th style="text-align: right;">food101</th>
<th style="text-align: right;">fashion_mnist</th>
<th style="text-align: right;">emnist_letters</th>
<th style="text-align: right;">kmnist</th>
<th style="text-align: right;">rendered-sst2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Pre-trained</td>
<td style="text-align: right;">63.18</td>
<td style="text-align: right;">59.58</td>
<td style="text-align: right;">60.27</td>
<td style="text-align: right;">45.00</td>
<td style="text-align: right;">31.63</td>
<td style="text-align: right;">32.53</td>
<td style="text-align: right;">48.26</td>
<td style="text-align: right;">44.20</td>
<td style="text-align: right;">66.45</td>
<td style="text-align: right;">60.64</td>
<td style="text-align: right;">41.25</td>
<td style="text-align: right;">83.32</td>
<td style="text-align: right;">97.12</td>
<td style="text-align: right;">63.72</td>
<td style="text-align: right;">89.83</td>
<td style="text-align: right;">82.36</td>
<td style="text-align: right;">63.01</td>
<td style="text-align: right;">11.98</td>
<td style="text-align: right;">9.95</td>
<td style="text-align: right;">58.65</td>
</tr>
<tr>
<td style="text-align: left;">Fine-Tuned</td>
<td style="text-align: right;">74.86</td>
<td style="text-align: right;">78.52</td>
<td style="text-align: right;">95.14</td>
<td style="text-align: right;">99.07</td>
<td style="text-align: right;">97.27</td>
<td style="text-align: right;">98.91</td>
<td style="text-align: right;">99.58</td>
<td style="text-align: right;">79.68</td>
<td style="text-align: right;">88.55</td>
<td style="text-align: right;">87.96</td>
<td style="text-align: right;">71.61</td>
<td style="text-align: right;">92.45</td>
<td style="text-align: right;">97.55</td>
<td style="text-align: right;">88.38</td>
<td style="text-align: right;">97.60</td>
<td style="text-align: right;">88.41</td>
<td style="text-align: right;">94.75</td>
<td style="text-align: right;">95.62</td>
<td style="text-align: right;">98.23</td>
<td style="text-align: right;">71.28</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th style="text-align: left;">Models</th>
<th style="text-align: right;">sun397</th>
<th style="text-align: right;">stanford-cars</th>
<th style="text-align: right;">resisc45</th>
<th style="text-align: right;">eurosat</th>
<th style="text-align: right;">svhn</th>
<th style="text-align: right;">gtsrb</th>
<th style="text-align: right;">mnist</th>
<th style="text-align: right;">dtd</th>
<th style="text-align: right;">oxford_flowers102</th>
<th style="text-align: right;">pcam</th>
<th style="text-align: right;">fer2013</th>
<th style="text-align: right;">oxford-iiit-pet</th>
<th style="text-align: right;">stl10</th>
<th style="text-align: right;">cifar100</th>
<th style="text-align: right;">cifar10</th>
<th style="text-align: right;">food101</th>
<th style="text-align: right;">fashion_mnist</th>
<th style="text-align: right;">emnist_letters</th>
<th style="text-align: right;">kmnist</th>
<th style="text-align: right;">rendered-sst2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Pre-Trained</td>
<td style="text-align: right;">65.54</td>
<td style="text-align: right;">64.68</td>
<td style="text-align: right;">66.38</td>
<td style="text-align: right;">54.11</td>
<td style="text-align: right;">51.99</td>
<td style="text-align: right;">43.45</td>
<td style="text-align: right;">51.73</td>
<td style="text-align: right;">45.00</td>
<td style="text-align: right;">71.31</td>
<td style="text-align: right;">54.02</td>
<td style="text-align: right;">46.39</td>
<td style="text-align: right;">88.44</td>
<td style="text-align: right;">98.25</td>
<td style="text-align: right;">66.33</td>
<td style="text-align: right;">90.77</td>
<td style="text-align: right;">87.01</td>
<td style="text-align: right;">67.30</td>
<td style="text-align: right;">12.44</td>
<td style="text-align: right;">11.21</td>
<td style="text-align: right;">60.57</td>
</tr>
<tr>
<td style="text-align: left;">Fine-Tuned</td>
<td style="text-align: right;">78.92</td>
<td style="text-align: right;">85.90</td>
<td style="text-align: right;">96.56</td>
<td style="text-align: right;">99.00</td>
<td style="text-align: right;">97.61</td>
<td style="text-align: right;">98.99</td>
<td style="text-align: right;">99.70</td>
<td style="text-align: right;">82.34</td>
<td style="text-align: right;">94.88</td>
<td style="text-align: right;">90.55</td>
<td style="text-align: right;">72.76</td>
<td style="text-align: right;">94.49</td>
<td style="text-align: right;">98.15</td>
<td style="text-align: right;">88.78</td>
<td style="text-align: right;">98.28</td>
<td style="text-align: right;">91.87</td>
<td style="text-align: right;">94.53</td>
<td style="text-align: right;">95.28</td>
<td style="text-align: right;">98.10</td>
<td style="text-align: right;">75.73</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th style="text-align: left;">Models</th>
<th style="text-align: right;">sun397</th>
<th style="text-align: right;">stanford-cars</th>
<th style="text-align: right;">resisc45</th>
<th style="text-align: right;">eurosat</th>
<th style="text-align: right;">svhn</th>
<th style="text-align: right;">gtsrb</th>
<th style="text-align: right;">mnist</th>
<th style="text-align: right;">dtd</th>
<th style="text-align: right;">oxford_flowers102</th>
<th style="text-align: right;">pcam</th>
<th style="text-align: right;">fer2013</th>
<th style="text-align: right;">oxford-iiit-pet</th>
<th style="text-align: right;">stl10</th>
<th style="text-align: right;">cifar100</th>
<th style="text-align: right;">cifar10</th>
<th style="text-align: right;">food101</th>
<th style="text-align: right;">fashion_mnist</th>
<th style="text-align: right;">emnist_letters</th>
<th style="text-align: right;">kmnist</th>
<th style="text-align: right;">rendered-sst2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Pre-Trained</td>
<td style="text-align: right;">68.22</td>
<td style="text-align: right;">77.86</td>
<td style="text-align: right;">71.33</td>
<td style="text-align: right;">61.19</td>
<td style="text-align: right;">58.43</td>
<td style="text-align: right;">50.52</td>
<td style="text-align: right;">76.31</td>
<td style="text-align: right;">55.53</td>
<td style="text-align: right;">79.25</td>
<td style="text-align: right;">51.21</td>
<td style="text-align: right;">49.96</td>
<td style="text-align: right;">93.21</td>
<td style="text-align: right;">99.36</td>
<td style="text-align: right;">75.05</td>
<td style="text-align: right;">95.59</td>
<td style="text-align: right;">91.18</td>
<td style="text-align: right;">66.96</td>
<td style="text-align: right;">12.34</td>
<td style="text-align: right;">9.71</td>
<td style="text-align: right;">68.92</td>
</tr>
<tr>
<td style="text-align: left;">Fine-Tuned</td>
<td style="text-align: right;">82.76</td>
<td style="text-align: right;">92.77</td>
<td style="text-align: right;">97.38</td>
<td style="text-align: right;">99.11</td>
<td style="text-align: right;">97.92</td>
<td style="text-align: right;">99.24</td>
<td style="text-align: right;">99.76</td>
<td style="text-align: right;">85.48</td>
<td style="text-align: right;">97.67</td>
<td style="text-align: right;">91.13</td>
<td style="text-align: right;">75.93</td>
<td style="text-align: right;">95.75</td>
<td style="text-align: right;">99.23</td>
<td style="text-align: right;">93.00</td>
<td style="text-align: right;">99.13</td>
<td style="text-align: right;">94.77</td>
<td style="text-align: right;">95.28</td>
<td style="text-align: right;">95.43</td>
<td style="text-align: right;">98.30</td>
<td style="text-align: right;">80.45</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h2 id="clipvisionmodelpool-implementation">CLIPVisionModelPool Implementation<a class="headerlink" href="#clipvisionmodelpool-implementation" title="Permanent link">&para;</a></h2>
<p>The <code>CLIPVisionModelPool</code> class extends the base <code>BaseModelPool</code> class and provides specialized functionality for managing CLIP Vision models from Hugging Face Transformers library.</p>
<h3 id="key-features">Key Features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Multi-platform Support</strong>: Supports both Hugging Face (<code>hf</code>) and ModelScope (<code>modelscope</code>) platforms.</li>
<li><strong>Model Loading</strong>: Handles CLIPVisionModel and CLIPModel loading with automatic path resolution</li>
<li><strong>Dataset Integration</strong>: Built-in support for loading train/validation/test datasets via the <code>datasets</code> library.</li>
<li><strong>Processor Management</strong>: Manages CLIPProcessor instances for consistent image preprocessing.</li>
<li><strong>Model Persistence</strong>: Save and load models with proper state preservation.</li>
</ul>
<h3 id="class-configuration">Class Configuration<a class="headerlink" href="#class-configuration" title="Permanent link">&para;</a></h3>
<p>The CLIPVisionModelPool accepts the following parameters:</p>
<ul>
<li><code>models</code> (DictConfig): Configuration mapping model names to their paths or configurations</li>
<li><code>processor</code> (Optional[DictConfig]): Configuration for the CLIP processor (defaults to corresponding CLIP model processor)</li>
<li><code>platform</code> (Literal["hf", "huggingface", "modelscope"]): Platform for model/dataset loading (default: "hf")</li>
<li><code>train_datasets</code>, <code>val_datasets</code>, <code>test_datasets</code> (Optional[DictConfig]): Dataset configurations</li>
</ul>
<h3 id="model-pool-configuration">Model Pool Configuration<a class="headerlink" href="#model-pool-configuration" title="Permanent link">&para;</a></h3>
<p>To use these models from our FusionBench library, you can specify the modelpool configuration file as follows:</p>
<div class="language-yaml highlight"><span class="filename">config/modelpool/CLIPVisionModelPool/clip-vit-base-patch32_TA8.yaml</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># eight image classification tasks defined in task arithmetic paper</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nt">defaults</span><span class="p">:</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/dataset/image_classification/train@train_datasets</span><span class="p">:</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sun397</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stanford-cars</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resisc45</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eurosat</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svhn</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gtsrb</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mnist</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dtd</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/dataset/image_classification/test@test_datasets</span><span class="p">:</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sun397</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stanford-cars</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resisc45</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eurosat</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svhn</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gtsrb</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mnist</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dtd</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_self_</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fusion_bench.modelpool.CLIPVisionModelPool</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="nt">_recursive_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="nt">processor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai/clip-vit-base-patch32</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="nt">models</span><span class="p">:</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="w">  </span><span class="nt">_pretrained_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai/clip-vit-base-patch32</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="w">  </span><span class="nt">sun397</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tanganke/clip-vit-base-patch32_sun397</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="w">  </span><span class="nt">stanford-cars</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tanganke/clip-vit-base-patch32_stanford-cars</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="w">  </span><span class="nt">resisc45</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tanganke/clip-vit-base-patch32_resisc45</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="w">  </span><span class="nt">eurosat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tanganke/clip-vit-base-patch32_eurosat</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="w">  </span><span class="nt">svhn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tanganke/clip-vit-base-patch32_svhn</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a><span class="w">  </span><span class="nt">gtsrb</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tanganke/clip-vit-base-patch32_gtsrb</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a><span class="w">  </span><span class="nt">mnist</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tanganke/clip-vit-base-patch32_mnist</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a><span class="w">  </span><span class="nt">dtd</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tanganke/clip-vit-base-patch32_dtd</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hf</span>
</span></code></pre></div>
<p>The configuration uses YAML's inheritance feature with the defaults key.
It inherits from a template (<code>_template.yaml</code>) and overrides specific values.
Some values are set to <code>???</code> or null, indicating that they need to be specified or can be optionally set when using this configuration.
This configuration structure allows for modular and reusable setups, making it easier to manage different model configurations within the FusionBench library.</p>
<div class="language-yaml highlight"><span class="filename">config/modelpool/CLIPVisionModelPool/_template.yaml</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nt">_usage_</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="no">defaults:</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="no">- CLIPVisionModelPool@: _template</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fusion_bench.modelpool.CLIPVisionModelPool</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nt">_recursive_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="nt">models</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="nt">train_datasets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="nt">test_datasets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="nt">processor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai/clip-vit-base-patch32</span>
</span></code></pre></div>
<p>The type of the modelpool is <code>fusion_bench.modelpool.CLIPVisionModelPool</code>.</p>
<h4 id="special-model-handling">Special Model Handling<a class="headerlink" href="#special-model-handling" title="Permanent link">&para;</a></h4>
<p>The modelpool recognizes special model names:</p>
<ul>
<li><code>_pretrained_</code>: Reserved name for the base pretrained model</li>
<li>All other names are treated as task-specific fine-tuned models</li>
<li>Use <code>has_pretrained</code> property to check for pretrained model availability</li>
<li>Access model lists via <code>all_model_names</code> (includes special) or <code>model_names</code> (excludes special)</li>
</ul>
<h4 id="basic-usage-example">Basic Usage Example<a class="headerlink" href="#basic-usage-example" title="Permanent link">&para;</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fusion_bench.modelpool</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPVisionModelPool</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">omegaconf</span><span class="w"> </span><span class="kn">import</span> <span class="n">DictConfig</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1"># Configure the model pool</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="n">config</span> <span class="o">=</span> <span class="n">DictConfig</span><span class="p">({</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>    <span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>        <span class="s2">&quot;_pretrained_&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span><span class="p">,</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>        <span class="s2">&quot;sun397&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/clip-vit-base-patch32_sun397&quot;</span><span class="p">,</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>        <span class="s2">&quot;cars&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/clip-vit-base-patch32_stanford-cars&quot;</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>    <span class="p">},</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>    <span class="s2">&quot;processor&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span><span class="p">,</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="p">})</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="c1"># Initialize the model pool</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">models</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">processor</span><span class="p">)</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="c1"># Load models</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="n">pretrained_model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;_pretrained_&quot;</span><span class="p">)</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="n">sun397_model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;sun397&quot;</span><span class="p">)</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="c1"># Load processor</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="n">processor</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_processor</span><span class="p">()</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="c1"># Load complete CLIP model</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="n">clip_model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_clip_model</span><span class="p">(</span><span class="s2">&quot;_pretrained_&quot;</span><span class="p">)</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="c1"># Check available models</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All models: </span><span class="si">{</span><span class="n">modelpool</span><span class="o">.</span><span class="n">all_model_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task-specific models: </span><span class="si">{</span><span class="n">modelpool</span><span class="o">.</span><span class="n">model_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Has pretrained model: </span><span class="si">{</span><span class="n">modelpool</span><span class="o">.</span><span class="n">has_pretrained</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="advanced-configuration-example">Advanced Configuration Example<a class="headerlink" href="#advanced-configuration-example" title="Permanent link">&para;</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fusion_bench.modelpool</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPVisionModelPool</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># Advanced configuration with custom loading parameters</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="n">models</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>        <span class="s2">&quot;_pretrained_&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>            <span class="s2">&quot;_target_&quot;</span><span class="p">:</span> <span class="s2">&quot;transformers.CLIPVisionModel.from_pretrained&quot;</span><span class="p">,</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>            <span class="s2">&quot;pretrained_model_name_or_path&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span><span class="p">,</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>            <span class="s2">&quot;torch_dtype&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>            <span class="s2">&quot;device_map&quot;</span><span class="p">:</span> <span class="s2">&quot;cuda:0&quot;</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>        <span class="p">},</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>        <span class="s2">&quot;sun397&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/clip-vit-base-patch32_sun397&quot;</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>    <span class="p">},</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>    <span class="n">processor</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>        <span class="s2">&quot;_target_&quot;</span><span class="p">:</span> <span class="s2">&quot;transformers.CLIPProcessor.from_pretrained&quot;</span><span class="p">,</span> 
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>        <span class="s2">&quot;pretrained_model_name_or_path&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>    <span class="p">},</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>    <span class="n">train_datasets</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>        <span class="s2">&quot;sun397&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/sun397&quot;</span><span class="p">,</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>        <span class="s2">&quot;cars&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/stanford-cars&quot;</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>    <span class="p">},</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="p">)</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="c1"># Load dataset</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_train_dataset</span><span class="p">(</span><span class="s2">&quot;sun397&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="working-with-modelscope-platform">Working with ModelScope Platform<a class="headerlink" href="#working-with-modelscope-platform" title="Permanent link">&para;</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Use ModelScope platform (popular in China)</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="n">models</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        <span class="s2">&quot;_pretrained_&quot;</span><span class="p">:</span> <span class="s2">&quot;openai-community/clip-vit-base-patch32&quot;</span><span class="p">,</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>        <span class="s2">&quot;custom_task&quot;</span><span class="p">:</span> <span class="s2">&quot;your-modelscope-username/custom-model&quot;</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="p">},</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="n">platform</span><span class="o">=</span><span class="s2">&quot;modelscope&quot;</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="p">)</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="c1"># Models and datasets will be loaded from ModelScope hub</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="n">model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;_pretrained_&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="lora-and-l-lora-models">LoRA and L-LoRA Models<a class="headerlink" href="#lora-and-l-lora-models" title="Permanent link">&para;</a></h3>
<p>We have fine-tuned CLIP-ViT-B/16 models on the eight image classification tasks using LoRA (Low-Rank Adaptation) and L-LoRA (Linearized LoRA) methods.</p>
<h4 id="training-configuration">Training Configuration<a class="headerlink" href="#training-configuration" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Target modules</strong>: <code>q_proj</code> and <code>v_proj</code> layers</li>
<li><strong>Learning rate</strong>: 1e-5 using Adam optimizer</li>
<li><strong>Training steps</strong>: 2000 steps</li>
<li><strong>Fine-tuning script</strong>: Available at <code>examples/clip_finetune/clip_finetune.sh</code></li>
</ul>
<h4 id="available-model-collections">Available Model Collections<a class="headerlink" href="#available-model-collections" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="https://huggingface.co/collections/tanganke/clip-vit-b-16-on-the-eight-image-classification-tasks-lora-66cd554ee7829e9dbb236c29">CLIP-ViT-B/16 on the eight image classification tasks (LoRA)</a></li>
<li><a href="https://huggingface.co/collections/tanganke/clip-vit-b-16-on-eight-image-classification-tasks-l-lora-66cd5b0e332ce5c7468d1bc6">CLIP-ViT-B/16 on eight image classification tasks (L-LoRA)</a></li>
</ul>
<h4 id="loading-lora-models">Loading LoRA Models<a class="headerlink" href="#loading-lora-models" title="Permanent link">&para;</a></h4>
<p>Load LoRA models using PEFT (see <a class="autorefs autorefs-internal" title="            load_lora_vision_model_hf(base_model_name, peft_name, merge_and_unload=False, return_vision_model=True)" href="../../api/fusion_bench.models/#fusion_bench.models.linearized.vision_model.load_lora_vision_model_hf">load_lora_vision_model_hf</a>):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPVisionModel</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">peft</span><span class="w"> </span><span class="kn">import</span> <span class="n">PeftModel</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># Load base model</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">base_model</span> <span class="o">=</span> <span class="n">CLIPVisionModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;openai/clip-vit-base-patch16&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">vision_model</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1"># Load LoRA adapter</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PeftModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">base_model</span><span class="p">,</span> <span class="n">peft_model_id</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="loading-l-lora-models">Loading L-LoRA Models<a class="headerlink" href="#loading-l-lora-models" title="Permanent link">&para;</a></h4>
<p>Load L-LoRA models using the specialized loader (refer to <a class="autorefs autorefs-internal" title="            load_l_lora_vision_model_hf(base_model_name, peft_name)" href="../../api/fusion_bench.models/#fusion_bench.models.linearized.vision_model.load_l_lora_vision_model_hf">load_l_lora_vision_model_hf</a>):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fusion_bench.models.linearized.vision_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_l_lora_vision_model_hf</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># Load L-LoRA model</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">load_l_lora_vision_model_hf</span><span class="p">(</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="n">base_model_name</span><span class="o">=</span><span class="s1">&#39;openai/clip-vit-base-patch16&#39;</span><span class="p">,</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    <span class="n">lora_model_name</span><span class="o">=</span><span class="n">lora_model_id</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="p">)</span>
</span></code></pre></div>
<h4 id="integration-with-clipvisionmodelpool">Integration with CLIPVisionModelPool<a class="headerlink" href="#integration-with-clipvisionmodelpool" title="Permanent link">&para;</a></h4>
<p>The CLIPVisionModelPool can be configured to work with LoRA/L-LoRA models by specifying appropriate model configurations:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fusion_bench.modelpool</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPVisionModelPool</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1"># Configure pool for LoRA models</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="n">models</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>        <span class="s2">&quot;_pretrained_&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch16&quot;</span><span class="p">,</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>        <span class="s2">&quot;sun397_lora&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>            <span class="s2">&quot;_target_&quot;</span><span class="p">:</span> <span class="s2">&quot;fusion_bench.models.linearized.vision_model.load_lora_vision_model_hf&quot;</span><span class="p">,</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>            <span class="s2">&quot;base_model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch16&quot;</span><span class="p">,</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>            <span class="s2">&quot;lora_model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/clip-vit-base-patch16_sun397_lora&quot;</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>        <span class="p">}</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>    <span class="p">}</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="p">)</span>
</span></code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Performance of the fine-tuned CLIP-ViT-B/16 models (LoRA-16)</label><label for="__tabbed_3_2">Performance of the fine-tuned CLIP-ViT-B/16 models (L-LoRA-16)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Model</th>
<th>SUN397</th>
<th>Cars</th>
<th>RESISC45</th>
<th>EuroSAT</th>
<th>SVHN</th>
<th>GTSRB</th>
<th>MNIST</th>
<th>DTD</th>
<th>Average</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUN397</td>
<td><strong>70.8</strong></td>
<td>64.8</td>
<td>66.7</td>
<td>55.4</td>
<td>51.8</td>
<td>44.0</td>
<td>52.2</td>
<td>46.0</td>
<td>56.5</td>
</tr>
<tr>
<td>Cars</td>
<td>65.8</td>
<td><strong>72.3</strong></td>
<td>65.7</td>
<td>54.5</td>
<td>52.3</td>
<td>44.1</td>
<td>54.1</td>
<td>45.3</td>
<td>56.8</td>
</tr>
<tr>
<td>RESISC45</td>
<td>66.2</td>
<td>64.6</td>
<td><strong>88.9</strong></td>
<td>65.4</td>
<td>51.8</td>
<td>43.6</td>
<td>54.7</td>
<td>45.6</td>
<td>60.1</td>
</tr>
<tr>
<td>EuroSAT</td>
<td>65.6</td>
<td>64.6</td>
<td>59.4</td>
<td><strong>97.1</strong></td>
<td>48.2</td>
<td>43.6</td>
<td>60.5</td>
<td>46.0</td>
<td>60.6</td>
</tr>
<tr>
<td>SVHN</td>
<td>65.5</td>
<td>64.1</td>
<td>65.3</td>
<td>39.1</td>
<td><strong>93.2</strong></td>
<td>45.5</td>
<td>83.0</td>
<td>45.1</td>
<td>62.6</td>
</tr>
<tr>
<td>GTSRB</td>
<td>65.5</td>
<td>63.9</td>
<td>64.2</td>
<td>28.6</td>
<td>56.9</td>
<td><strong>91.0</strong></td>
<td>71.3</td>
<td>45.5</td>
<td>60.9</td>
</tr>
<tr>
<td>MNIST</td>
<td>65.3</td>
<td>64.1</td>
<td>65.7</td>
<td>51.9</td>
<td>57.6</td>
<td>46.6</td>
<td><strong>98.4</strong></td>
<td>45.2</td>
<td>61.9</td>
</tr>
<tr>
<td>DTD</td>
<td>64.5</td>
<td>64.2</td>
<td>61.0</td>
<td>49.1</td>
<td>54.2</td>
<td>44.2</td>
<td>68.0</td>
<td><strong>67.9</strong></td>
<td>59.1</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Model</th>
<th>SUN397</th>
<th>Cars</th>
<th>RESISC45</th>
<th>EuroSAT</th>
<th>SVHN</th>
<th>GTSRB</th>
<th>MNIST</th>
<th>DTD</th>
<th>Average</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUN397</td>
<td><strong>69.0</strong></td>
<td>65.0</td>
<td>66.7</td>
<td>56.0</td>
<td>52.6</td>
<td>44.0</td>
<td>53.3</td>
<td>45.4</td>
<td>56.5</td>
</tr>
<tr>
<td>Cars</td>
<td>65.8</td>
<td><strong>69.7</strong></td>
<td>65.7</td>
<td>54.4</td>
<td>52.0</td>
<td>43.7</td>
<td>52.6</td>
<td>45.3</td>
<td>56.2</td>
</tr>
<tr>
<td>RESISC45</td>
<td>65.9</td>
<td>64.3</td>
<td><strong>83.6</strong></td>
<td>66.3</td>
<td>51.7</td>
<td>43.4</td>
<td>51.9</td>
<td>45.6</td>
<td>59.1</td>
</tr>
<tr>
<td>EuroSAT</td>
<td>65.5</td>
<td>64.8</td>
<td>64.2</td>
<td><strong>95.4</strong></td>
<td>50.7</td>
<td>43.8</td>
<td>58.4</td>
<td>45.9</td>
<td>61.1</td>
</tr>
<tr>
<td>SVHN</td>
<td>65.3</td>
<td>64.4</td>
<td>65.2</td>
<td>46.6</td>
<td><strong>90.1</strong></td>
<td>45.8</td>
<td>80.0</td>
<td>45.4</td>
<td>62.9</td>
</tr>
<tr>
<td>GTSRB</td>
<td>65.5</td>
<td>64.4</td>
<td>64.2</td>
<td>43.8</td>
<td>59.5</td>
<td><strong>78.6</strong></td>
<td>72.6</td>
<td>45.2</td>
<td>61.7</td>
</tr>
<tr>
<td>MNIST</td>
<td>65.3</td>
<td>64.5</td>
<td>65.0</td>
<td>53.3</td>
<td>57.6</td>
<td>45.6</td>
<td><strong>96.4</strong></td>
<td>45.5</td>
<td>61.7</td>
</tr>
<tr>
<td>DTD</td>
<td>65.7</td>
<td>64.7</td>
<td>65.9</td>
<td>54.5</td>
<td>51.6</td>
<td>44.4</td>
<td>58.2</td>
<td><strong>56.2</strong></td>
<td>57.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><img alt="alt text" src="../images/clip-vit-base-patch16_full%26lora%26l-lora.png" width="1000px" />
<img alt="alt text" src="../images/clip-vit-base-patch16_full%26lora%26l-lora_average.png" width="1000px" /></p>
<h2 id="usage-examples">Usage Examples<a class="headerlink" href="#usage-examples" title="Permanent link">&para;</a></h2>
<p>This section demonstrates various ways to use CLIP-ViT models for open vocabulary image classification with different fusion methods using the <a href="../../cli/fusion_bench/"><code>fusion_bench</code></a> command line interface and the CLIPVisionModelPool API.</p>
<h3 id="model-information-inspection">Model Information Inspection<a class="headerlink" href="#model-information-inspection" title="Permanent link">&para;</a></h3>
<p>Inspect basic information about CLIP-ViT models including parameter counts:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Inspect CLIP-ViT-B/32 model</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>dummy<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_individual<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>dummy<span class="w">  </span><span class="c1"># dummy task reports basic model information (e.g., parameter count)</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c1"># Output:</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="c1"># {&#39;model_info&#39;: {&#39;trainable_params&#39;: 87456000, &#39;all_params&#39;: 87456000, &#39;trainable_percentage&#39;: 1.0}}</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="c1"># Inspect CLIP-ViT-L/14 model</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>dummy<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_individual<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>dummy
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="c1"># Output:</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="c1"># {&#39;model_info&#39;: {&#39;trainable_params&#39;: 303179776, &#39;all_params&#39;: 303179776, &#39;trainable_percentage&#39;: 1.0}}</span>
</span></code></pre></div>
<h4 id="programmatic-model-information">Programmatic Model Information<a class="headerlink" href="#programmatic-model-information" title="Permanent link">&para;</a></h4>
<p>You can also inspect models programmatically using the CLIPVisionModelPool:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fusion_bench.modelpool</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLIPVisionModelPool</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># Initialize model pool</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    <span class="n">models</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;clip_model&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span><span class="p">}</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="p">)</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="c1"># Load and inspect model</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="n">model</span> <span class="o">=</span> <span class="n">modelpool</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;clip_model&quot;</span><span class="p">)</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="n">total_params</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="n">trainable_params</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total parameters: </span><span class="si">{</span><span class="n">total_params</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trainable parameters: </span><span class="si">{</span><span class="n">trainable_params</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model architecture: </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="single-model-evaluation">Single Model Evaluation<a class="headerlink" href="#single-model-evaluation" title="Permanent link">&para;</a></h3>
<p>evaluate a single CLIP-ViT-B/32 model on the eight downstream tasks:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="nv">path_to_clip_model</span><span class="o">=</span><span class="s2">&quot;tanganke/clip-vit-base-patch32_sun397&quot;</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>dummy<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_individual<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">    </span>modelpool.models._pretrained_.pretrained_model_name_or_path<span class="o">=</span><span class="s2">&quot;&#39;</span><span class="si">${</span><span class="nv">path_to_clip_model</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8
</span></code></pre></div>
<p>Here:</p>
<ul>
<li>The <code>dummy</code> method is a special method used to skip the model merging process, it loads the pre-trained model in the modelpool and return the model without any modification (or the first model when a model with the name <code>_pretrained_</code> does not exist in modelpool), see <a href="../../algorithms/dummy/">dummy method</a> for more information. </li>
<li>The <code>CLIPVisionModelPool/clip-vit-base-patch32_individual</code> modelpool contains a single model. By passing argument <code>modelpool.models.0.path=...</code>, we override the path of the model with the specified path.
<div class="language-yaml highlight"><span class="filename">config/modelpool/CLIPVisionModelPool/clip-vit-base-patch32_individual.yaml</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fusion_bench.modelpool.CLIPVisionModelPool</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="nt">_recursive_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="nt">models</span><span class="p">:</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">  </span><span class="nt">_pretrained_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai/clip-vit-base-patch32</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="nt">processor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${.models._pretrained_}</span>
</span></code></pre></div></li>
<li>The <code>CLIPVisionModelTaskPool/clip-vit-classification_TA8</code> taskpool is used to evaluate the model on the eight tasks.
  if <code>$path_to_clip_model</code> is not specified, the pre-trained model from HuggingFace will be used by default.
<div class="language-yaml highlight"><span class="filename">config/taskpool/CLIPVisionModelTaskPool/clip-vit-classification_TA8.yaml</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nt">defaults</span><span class="p">:</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">CLIPVisionModelTaskPool@</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_template</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/dataset/image_classification/test@test_datasets</span><span class="p">:</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sun397</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stanford-cars</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resisc45</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eurosat</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svhn</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gtsrb</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mnist</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dtd</span>
</span></code></pre></div></li>
</ul>
<p>Use a for loop to evaluate multiple CLIP-ViT-B/32 model on the eight tasks, and save reports to json files:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">for</span><span class="w"> </span>task<span class="w"> </span><span class="k">in</span><span class="w"> </span>sun397<span class="w"> </span>stanford-cars<span class="w"> </span>resisc45<span class="w"> </span>eurosat<span class="w"> </span>svhn<span class="w"> </span>gtsrb<span class="w"> </span>mnist<span class="w"> </span>dtd
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="k">do</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>dummy<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">        </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_individual<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">            </span>modelpool.models._pretrained_.pretrained_model_name_or_path<span class="o">=</span>tanganke/clip-vit-base-patch32_<span class="si">${</span><span class="nv">task</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">        </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">        </span><span class="nv">report_save_path</span><span class="o">=</span><span class="s2">&quot;outputs/ViT-B-32/single-task/clip-vit-base-patch32_</span><span class="si">${</span><span class="nv">task</span><span class="si">}</span><span class="s2">.json&quot;</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="k">done</span>
</span></code></pre></div>
<p>evaluate the CLIP-ViT-L/14 model on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>dummy<span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_individual<span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span>modelpool.models._pretrained_.pretrained_model_name_or_path<span class="o">=</span><span class="s2">&quot;&#39;</span><span class="si">${</span><span class="nv">path_to_clip_model</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<h3 id="simple-averaging">Simple Averaging<a class="headerlink" href="#simple-averaging" title="Permanent link">&para;</a></h3>
<p>merge CLIP-ViT-B/32 models using simple average and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>simple_average<span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8_model_only<span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8<span class="w"> </span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="c1"># results</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="o">{</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">    </span><span class="s2">&quot;svhn&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.6451674699783325,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.128771424293518<span class="o">}</span>,
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">    </span><span class="s2">&quot;stanford_cars&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.625668466091156,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.135254979133606<span class="o">}</span>,
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="w">    </span><span class="s2">&quot;resisc45&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.7079365253448486,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">0</span>.9697789549827576<span class="o">}</span>,
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">    </span><span class="s2">&quot;eurosat&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.7685185074806213,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">0</span>.6301173567771912<span class="o">}</span>,
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="w">    </span><span class="s2">&quot;gtsrb&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.5494061708450317,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.492265224456787<span class="o">}</span>,
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="w">    </span><span class="s2">&quot;mnist&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.8626000285148621,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">0</span>.5933865308761597<span class="o">}</span>,
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="w">    </span><span class="s2">&quot;dtd&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.5090425610542297,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.79731023311615<span class="o">}</span>,
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="w">    </span><span class="s2">&quot;sun397&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.6543576717376709,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.1993952989578247<span class="o">}</span>,
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="o">}</span>
</span></code></pre></div>
<p>merge CLIP-ViT-L/14 models using simple average and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>simple_average<span class="w"> </span><span class="se">\</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8_model_only<span class="w"> </span><span class="se">\</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<h3 id="fisher-merging">Fisher Merging<a class="headerlink" href="#fisher-merging" title="Permanent link">&para;</a></h3>
<p>merge CLIP-ViT-B/32 models using Fisher Merging and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>fisher_merging/clip_fisher_merging<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8
</span></code></pre></div>
<p>merge CLIP-ViT-L/14 models using Fisher Merging and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>fisher_merging/clip_fisher_merging<span class="w"> </span><span class="se">\</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span>method.dataloader_kwargs.batch_size<span class="o">=</span><span class="m">8</span><span class="w"> </span>method.dataloader_kwargs.num_workers<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<h3 id="regmean">RegMean<a class="headerlink" href="#regmean" title="Permanent link">&para;</a></h3>
<p>merge CLIP-ViT-B/32 models using RegMean and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>regmean/clip_regmean<span class="w"> </span><span class="se">\</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8
</span></code></pre></div>
<p>For CLIP-ViT-L/14 models:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>regmean/clip_regmean<span class="w"> </span><span class="se">\</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">    </span>method.dataloader_kwargs.batch_size<span class="o">=</span><span class="m">8</span><span class="w"> </span>method.dataloader_kwargs.num_workers<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<h3 id="regmean_1">RegMean++<a class="headerlink" href="#regmean_1" title="Permanent link">&para;</a></h3>
<p>Run and evaluate the RegMean++ algorithm on eight image classification tasks:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">for</span><span class="w"> </span>model<span class="w"> </span><span class="k">in</span><span class="w"> </span>clip-vit-base-patch32<span class="w"> </span>clip-vit-base-patch16<span class="w"> </span>clip-vit-large-patch14
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">do</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">  </span>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">      </span><span class="nv">method</span><span class="o">=</span>regmean_plusplus/clip_regmean_plusplus<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">      </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/<span class="si">${</span><span class="nv">model</span><span class="si">}</span>_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="w">      </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">        </span>taskpool.base_model<span class="o">=</span>openai/<span class="si">${</span><span class="nv">model</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="w">      </span><span class="nv">report_save_path</span><span class="o">=</span>outputs/<span class="si">${</span><span class="nv">model</span><span class="si">}</span>_TA8_regmean_plusplus.json
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="k">done</span>
</span></code></pre></div>
<h3 id="task-arithmetic">Task Arithmetic<a class="headerlink" href="#task-arithmetic" title="Permanent link">&para;</a></h3>
<p>merge CLIP-ViT-B/32 models using task arithmetic and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>task_arithmetic<span class="w"> </span>method.scaling_factor<span class="o">=</span><span class="m">0</span>.3<span class="se">\</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="c1"># results</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="o">{</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">    </span><span class="s2">&quot;svhn&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.77927166223526,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">0</span>.7050645351409912<span class="o">}</span>,
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">    </span><span class="s2">&quot;stanford_cars&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.5565228462219238,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.4873239994049072<span class="o">}</span>,
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">    </span><span class="s2">&quot;resisc45&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.6487301588058472,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.3709946870803833<span class="o">}</span>,
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">    </span><span class="s2">&quot;eurosat&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.7674074172973633,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">0</span>.6550557017326355<span class="o">}</span>,
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">    </span><span class="s2">&quot;gtsrb&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.6850356459617615,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.2349143028259277<span class="o">}</span>,
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="w">    </span><span class="s2">&quot;mnist&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.9606999754905701,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">0</span>.1570172756910324<span class="o">}</span>,
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="w">    </span><span class="s2">&quot;dtd&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.471808522939682,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">2</span>.1495635509490967<span class="o">}</span>,
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="w">    </span><span class="s2">&quot;sun397&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;accuracy&quot;</span>:<span class="w"> </span><span class="m">0</span>.571083128452301,<span class="w"> </span><span class="s2">&quot;loss&quot;</span>:<span class="w"> </span><span class="m">1</span>.7016042470932007<span class="o">}</span>,
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="o">}</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1"># or use a for loop to try different scaling factors </span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c1"># and save the results to different files</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="k">for</span><span class="w"> </span>scaling_factor<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.1<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span><span class="m">0</span>.3<span class="w"> </span><span class="m">0</span>.4<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.6<span class="w"> </span><span class="m">0</span>.7<span class="w"> </span><span class="m">0</span>.8<span class="w"> </span><span class="m">0</span>.9<span class="w"> </span><span class="m">1</span>.0
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="k">do</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">  </span>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">    </span><span class="nv">method</span><span class="o">=</span>task_arithmetic<span class="w"> </span>method.scaling_factor<span class="o">=</span><span class="nv">$scaling_factor</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="w">    </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="w">    </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="w">    </span><span class="nv">report_save_path</span><span class="o">=</span>outputs/clip-vit-base-patch32_TA8_task_arithmetic_scaling_factor_<span class="si">${</span><span class="nv">scaling_factor</span><span class="si">}</span>.json
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="k">done</span>
</span></code></pre></div>
<p>merge CLIP-ViT-L/14 models using task arithmetic and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>task_arithmetic<span class="w"> </span>method.scaling_factor<span class="o">=</span><span class="m">0</span>.3<span class="se">\</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<h3 id="ties-merging">Ties-Merging<a class="headerlink" href="#ties-merging" title="Permanent link">&para;</a></h3>
<p>merge CLIP-ViT-B/32 models using Ties-Merging and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>ties_merging<span class="w"> </span>method.scaling_factor<span class="o">=</span><span class="m">0</span>.3<span class="w"> </span>method.threshold<span class="o">=</span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># or use a for loop to try different scaling factors</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="c1"># and save the results to different files</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="k">for</span><span class="w"> </span>scaling_factor<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.1<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span><span class="m">0</span>.3<span class="w"> </span><span class="m">0</span>.4<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.6<span class="w"> </span><span class="m">0</span>.7<span class="w"> </span><span class="m">0</span>.8<span class="w"> </span><span class="m">0</span>.9<span class="w"> </span><span class="m">1</span>.0
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="k">do</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">  </span>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">    </span><span class="nv">method</span><span class="o">=</span>ties_merging<span class="w"> </span>method.scaling_factor<span class="o">=</span><span class="nv">$scaling_factor</span><span class="w"> </span>method.threshold<span class="o">=</span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">    </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">    </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="w">    </span><span class="nv">report_save_path</span><span class="o">=</span>outputs/clip-vit-base-patch32_TA8_ties_merging_scaling_factor_<span class="si">${</span><span class="nv">scaling_factor</span><span class="si">}</span>.json
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="k">done</span>
</span></code></pre></div>
<p>merge CLIP-ViT-L/14 models using Ties-Merging and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>fusion_bench<span class="w"> </span><span class="nv">method</span><span class="o">=</span>ties_merging<span class="w"> </span>method.scaling_factor<span class="o">=</span><span class="m">0</span>.3<span class="w"> </span>method.threshold<span class="o">=</span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<h3 id="adamerging"><a href="../../algorithms/adamerging/">AdaMerging</a><a class="headerlink" href="#adamerging" title="Permanent link">&para;</a></h3>
<p>merge CLIP-ViT-B/32 models using task-wise AdaMerging and evaluate on the eight tasks, and save the merging weights by specifying the <code>method.save_merging_weights</code> parameter</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>adamerging/clip<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span>method.name<span class="o">=</span>clip_task_wise_adamerging<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span>method.save_merging_weights<span class="o">=</span>outputs/clip-vit-base-patch32_TA8_task_wise_adamerging_weights.pt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8
</span></code></pre></div>
<p>merge CLIP-ViT-L/14 models using task-wise AdaMerging and evaluate on the eight tasks, and save the merging weights by specifying the <code>method.save_merging_weights</code> parameter.
Here we split the training process into two stages, the first stage is to train the merging weights, and the second stage is to evaluate the model with the learned merging weights.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c1"># learn the merging weights.</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="c1"># the per-device batch size is 4, and the total batch size is 4*4=16</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>fusion_bench<span class="w"> </span><span class="nv">print_config</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>adamerging/clip<span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">    </span>method.name<span class="o">=</span>clip_task_wise_adamerging<span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="w">    </span>method.save_merging_weights<span class="o">=</span>outputs/clip-vit-large-patch14_TA8_task_wise_adamerging_weights.pt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w">    </span>method.devices<span class="o">=</span><span class="m">4</span><span class="w"> </span>method.batch_size<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>dummy<span class="w"> </span><span class="c1"># dummy taskpool is used to skip the evaluation process</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="c1"># by specifying the learned merging weights, we skip the training process and directly evaluate the model</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>fusion_bench<span class="w"> </span><span class="nv">print_config</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>adamerging/clip<span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="w">    </span>method.name<span class="o">=</span>clip_task_wise_adamerging<span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="w">    </span>method.weights<span class="o">=</span>outputs/clip-vit-large-patch14_TA8_task_wise_adamerging_weights.pt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<p>merge CLIP-ViT-B/32 models using layer-wise AdaMerging and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">    </span><span class="nv">method</span><span class="o">=</span>adamerging/clip<span class="w"> </span><span class="se">\</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">        </span>method.name<span class="o">=</span>clip_layer_wise_adamerging<span class="w"> </span><span class="se">\</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">        </span>method.save_merging_weights<span class="o">=</span>merging_weights.pt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="w">    </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="w">    </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="w">    </span>fabric.loggers.root_dir<span class="o">=</span>outputs/logs/ViT-B-32<span class="w"> </span><span class="se">\</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="w">    </span>fabric.loggers.name<span class="o">=</span>clip_layer_wise_adamerging_adamerging
</span></code></pre></div>
<p>merge CLIP-ViT-L/14 models using layer-wise AdaMerging and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c1"># learn the merging weights.</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="c1"># the per-device batch size is 4, and the total batch size is 4*4=16</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>fusion_bench<span class="w"> </span><span class="nv">print_config</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>adamerging/clip<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="w">    </span>method.name<span class="o">=</span>clip_layer_wise_adamerging<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="w">    </span>method.save_merging_weights<span class="o">=</span>outputs/clip-vit-large-patch14_TA8_layer_wise_adamerging_weights.pt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="w">    </span>method.devices<span class="o">=</span><span class="m">4</span><span class="w"> </span>method.batch_size<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>dummy<span class="w"> </span><span class="c1"># dummy taskpool is used to skip the evaluation process</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="c1"># by specifying the learned merging weights, we skip the training process and directly evaluate the model</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>adamerging/clip<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="w">    </span>method.name<span class="o">=</span>clip_layer_wise_adamerging<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="w">    </span>method.weights<span class="o">=</span>outputs/clip-vit-large-patch14_TA8_layer_wise_adamerging_weights.pt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<h3 id="weight-ensembling-moe">Weight-Ensembling MoE<a class="headerlink" href="#weight-ensembling-moe" title="Permanent link">&para;</a></h3>
<p>fuse CLIP-ViT-B/32 models using Weight-Ensembling Mixture of Experts and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>weight_ensembling_moe<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">    </span>method.name<span class="o">=</span>clip_weight_ensembling_moe<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">    </span>method.use_grad_accumulate<span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">    </span>method.save_checkpoint<span class="o">=</span>outputs/clip-vit-base-patch32_TA8_weight_ensembling_moe_checkpoint.ckpt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8
</span></code></pre></div>
<p>fuse CLIP-ViT-L/14 models using Weight-Ensembling Mixture of Experts and evaluate on the eight tasks</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c1"># merge eight CLIP-ViT-L/14 models using WE MoE, fine-tune the routers</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>fusion_bench<span class="w"> </span><span class="nv">print_config</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>weight_ensembling_moe<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">    </span>method.name<span class="o">=</span>clip_weight_ensembling_moe<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w">    </span>method.use_grad_accumulate<span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="w">    </span>method.save_checkpoint<span class="o">=</span>outputs/clip-vit-large-patch14_TA8_weight_ensembling_moe_checkpoint.ckpt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="w">    </span>method.batch_size<span class="o">=</span><span class="m">4</span><span class="w"> </span>method.devices<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>dummy<span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="c1"># load the checkpoint and evaluate the model</span>
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>weight_ensembling_moe<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="w">    </span>method.name<span class="o">=</span>clip_weight_ensembling_moe<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="w">    </span>method.checkpoint<span class="o">=</span>outputs/clip-vit-large-patch14_TA8_weight_ensembling_moe_checkpoint.ckpt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-16"><a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-large-patch14_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-17"><a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>CLIPVisionModelTaskPool/clip-vit-classification_TA8_L14
</span></code></pre></div>
<h3 id="experimental-results">Experimental Results<a class="headerlink" href="#experimental-results" title="Permanent link">&para;</a></h3>
<p>We provide the experimental results of the CLIP-ViT models for open vocabulary image classification on the eight tasks in the following table.</p>
<div class="admonition info">
<p class="admonition-title">Hyperparameters not fully optimized</p>
<p>The hyperparameters used in these merging methods are not fully optimized and should be considered as preliminary results only. We welcome any discoveries of more effective parameters and would be grateful for your contributions to help us improve our results.</p>
<p>Please note that some model merging paper results were obtained using <a href="https://github.com/mlfoundations/task_vectors">OpenCLIP models</a>, which may show discrepancies with the results presented here. In such cases, the results reported in the original papers should be considered authoritative.</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Table: Multi-task model merging methods using CLIP-ViT-B/32 models.</label><label for="__tabbed_4_2">Table: Multi-task model merging methods using CLIP-ViT-B/16 models.</label><label for="__tabbed_4_3">Table: Multi-task model merging methods using CLIP-ViT-L/14 models.</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Method</th>
<th>SUN397</th>
<th>Cars</th>
<th>RESISC45</th>
<th>EuroSAT</th>
<th>SVHN</th>
<th>GTSRB</th>
<th>MNIST</th>
<th>DTD</th>
<th>Average</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reference Results</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Pre-trained</td>
<td>63.2</td>
<td>59.8</td>
<td>60.7</td>
<td>46.0</td>
<td>31.6</td>
<td>32.5</td>
<td>48.2</td>
<td>43.9</td>
<td>48.2</td>
</tr>
<tr>
<td>Fine-tuned (STL)</td>
<td>75.0</td>
<td>78.3</td>
<td>95.2</td>
<td>99.0</td>
<td>97.3</td>
<td>98.9</td>
<td>99.6</td>
<td>79.7</td>
<td>90.3</td>
</tr>
<tr>
<td>Traditional MTL</td>
<td>72.3</td>
<td>76.6</td>
<td>92.2</td>
<td>97.9</td>
<td>95.5</td>
<td>97.7</td>
<td>99.3</td>
<td>77.7</td>
<td>88.6</td>
</tr>
<tr>
<td>Model Ensemble</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Simple Ensemble</td>
<td>64.9</td>
<td>63.5</td>
<td>75.7</td>
<td>93.7</td>
<td>85.7</td>
<td>73.8</td>
<td>93.8</td>
<td>55.1</td>
<td>75.8</td>
</tr>
<tr>
<td>Model Merging</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Simple Averaging</td>
<td>65.4</td>
<td>62.6</td>
<td>70.8</td>
<td>76.9</td>
<td>64.5</td>
<td>54.9</td>
<td>86.3</td>
<td>50.9</td>
<td>66.5</td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>66.7</td>
<td>64.0</td>
<td>72.2</td>
<td>91.6</td>
<td>69.0</td>
<td>64.3</td>
<td>83.5</td>
<td>53.7</td>
<td>70.6</td>
</tr>
<tr>
<td>RegMean</td>
<td>68.6</td>
<td>70.0</td>
<td>84.6</td>
<td>95.4</td>
<td>92.6</td>
<td>83.4</td>
<td>98.4</td>
<td>66.1</td>
<td>82.4</td>
</tr>
<tr>
<td>RegMean++</td>
<td>69.3</td>
<td>70.5</td>
<td>86.7</td>
<td>96.1</td>
<td>94.1</td>
<td>90.4</td>
<td>99.0</td>
<td>68.7</td>
<td>84.4</td>
</tr>
<tr>
<td>Task Arithmetic (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>57.1</td>
<td>55.7</td>
<td>64.9</td>
<td>76.7</td>
<td>77.9</td>
<td>68.5</td>
<td>96.1</td>
<td>47.2</td>
<td>68.0</td>
</tr>
<tr>
<td>Concrete Task Arithmetic (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>64.2</td>
<td>63.3</td>
<td>75.6</td>
<td>94.1</td>
<td>90.3</td>
<td>82.9</td>
<td>98.0</td>
<td>52.5</td>
<td>77.6</td>
</tr>
<tr>
<td>Ties-Merging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>67.1</td>
<td>64.2</td>
<td>74.1</td>
<td>76.8</td>
<td>77.7</td>
<td>69.4</td>
<td>94.1</td>
<td>54.0</td>
<td>72.2</td>
</tr>
<tr>
<td>Task-wise AdaMerging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>58.6</td>
<td>56.9</td>
<td>69.8</td>
<td>82.4</td>
<td>70.3</td>
<td>58.9</td>
<td>97.2</td>
<td>55.3</td>
<td>68.7</td>
</tr>
<tr>
<td>Layer-wise AdaMerging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>67.9</td>
<td>71.3</td>
<td>83.5</td>
<td>92.7</td>
<td>87.4</td>
<td>92.9</td>
<td>98.2</td>
<td>67.0</td>
<td>82.6</td>
</tr>
<tr>
<td>Concrete Layer-wise AdaMerging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>69.1</td>
<td>72.7</td>
<td>85.9</td>
<td>94.7</td>
<td>91.3</td>
<td>95.7</td>
<td>98.7</td>
<td>66.8</td>
<td>84.4</td>
</tr>
<tr>
<td>WUDI-Merging</td>
<td>68.0</td>
<td>72.5</td>
<td>85.0</td>
<td>94.6</td>
<td>94.8</td>
<td>94.9</td>
<td>99.3</td>
<td>66.6</td>
<td>84.5</td>
</tr>
<tr>
<td>Model Mixing</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Efficient Weight-Ensembling MoE (<span class="arithmatex">\(90\%\)</span>)</td>
<td>74.3</td>
<td>76.3</td>
<td>92.7</td>
<td>97.9</td>
<td>96.1</td>
<td>98.6</td>
<td>99.5</td>
<td>77.8</td>
<td>89.1</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>73.7</td>
<td>76.8</td>
<td>93.4</td>
<td>98.2</td>
<td>96.8</td>
<td>98.2</td>
<td>99.6</td>
<td>76.6</td>
<td>89.2</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Method</th>
<th>SUN397</th>
<th>Cars</th>
<th>RESISC45</th>
<th>EuroSAT</th>
<th>SVHN</th>
<th>GTSRB</th>
<th>MNIST</th>
<th>DTD</th>
<th>Average</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reference Results</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Pre-trained</td>
<td>65.5</td>
<td>64.6</td>
<td>66.3</td>
<td>54.1</td>
<td>51.9</td>
<td>43.4</td>
<td>51.7</td>
<td>44.9</td>
<td>55.3</td>
</tr>
<tr>
<td>Fine-tuned (STL)</td>
<td>78.9</td>
<td>85.9</td>
<td>96.6</td>
<td>99.0</td>
<td>97.6</td>
<td>99.0</td>
<td>99.7</td>
<td>82.3</td>
<td>92.3</td>
</tr>
<tr>
<td>Model Merging</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Simple Averaging</td>
<td>68.7</td>
<td>69.0</td>
<td>75.0</td>
<td>83.2</td>
<td>74.9</td>
<td>62.5</td>
<td>93.7</td>
<td>51.1</td>
<td>72.3</td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>70.8</td>
<td>71.8</td>
<td>76.2</td>
<td>93.4</td>
<td>77.4</td>
<td>61.2</td>
<td>90.7</td>
<td>52.3</td>
<td>74.2</td>
</tr>
<tr>
<td>RegMean</td>
<td>72.6</td>
<td>78.8</td>
<td>89.2</td>
<td>96.3</td>
<td>94.9</td>
<td>90.0</td>
<td>98.8</td>
<td>67.9</td>
<td>86.0</td>
</tr>
<tr>
<td>RegMean++</td>
<td>72.8</td>
<td>78.9</td>
<td>89.3</td>
<td>97.3</td>
<td>96.0</td>
<td>93.0</td>
<td>99.1</td>
<td>71.0</td>
<td>87.2</td>
</tr>
<tr>
<td>Task Arithmetic (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>65.9</td>
<td>68.3</td>
<td>75.4</td>
<td>84.5</td>
<td>88.8</td>
<td>81.9</td>
<td>98.0</td>
<td>53.9</td>
<td>77.1</td>
</tr>
<tr>
<td>Ties-Merging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>70.6</td>
<td>71.2</td>
<td>79.8</td>
<td>87.5</td>
<td>83.2</td>
<td>76.2</td>
<td>96.4</td>
<td>55.4</td>
<td>77.5</td>
</tr>
<tr>
<td>Layer-wise AdaMerging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>70.6</td>
<td>79.6</td>
<td>86.1</td>
<td>93.6</td>
<td>93.5</td>
<td>95.4</td>
<td>98.1</td>
<td>62.9</td>
<td>85.0</td>
</tr>
<tr>
<td>Model Mixing</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Efficient Weight-Ensembling MoE (<span class="arithmatex">\(90\%\)</span>)</td>
<td>77.7</td>
<td>85.0</td>
<td>94.9</td>
<td>98.2</td>
<td>97.2</td>
<td>98.9</td>
<td>99.5</td>
<td>81.4</td>
<td>91.6</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>77.2</td>
<td>85.0</td>
<td>94.8</td>
<td>98.3</td>
<td>97.3</td>
<td>98.9</td>
<td>99.6</td>
<td>80.8</td>
<td>91.5</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Method</th>
<th>SUN397</th>
<th>Cars</th>
<th>RESISC45</th>
<th>EuroSAT</th>
<th>SVHN</th>
<th>GTSRB</th>
<th>MNIST</th>
<th>DTD</th>
<th>Average</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reference Results</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Pre-trained</td>
<td>68.3</td>
<td>77.8</td>
<td>71.0</td>
<td>58.9</td>
<td>58.4</td>
<td>50.6</td>
<td>76.4</td>
<td>55.5</td>
<td>64.6</td>
</tr>
<tr>
<td>Fine-tuned (STL)</td>
<td>82.8</td>
<td>92.9</td>
<td>97.4</td>
<td>99.2</td>
<td>97.9</td>
<td>99.2</td>
<td>99.8</td>
<td>85.5</td>
<td>94.3</td>
</tr>
<tr>
<td>Traditional MTL</td>
<td>79.0</td>
<td>89.3</td>
<td>94.5</td>
<td>98.4</td>
<td>96.4</td>
<td>98.1</td>
<td>99.4</td>
<td>83.7</td>
<td>92.4</td>
</tr>
<tr>
<td>Model Merging</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Simple Averaging</td>
<td>72.5</td>
<td>81.5</td>
<td>82.2</td>
<td>90.0</td>
<td>81.6</td>
<td>74.0</td>
<td>96.6</td>
<td>61.8</td>
<td>80.0</td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>70.6</td>
<td>79.4</td>
<td>84.1</td>
<td>98.1</td>
<td>74.7</td>
<td>85.0</td>
<td>89.5</td>
<td>61.0</td>
<td>80.3</td>
</tr>
<tr>
<td>RegMean</td>
<td>76.9</td>
<td>89.8</td>
<td>93.0</td>
<td>97.5</td>
<td>96.3</td>
<td>94.1</td>
<td>98.7</td>
<td>77.0</td>
<td>90.4</td>
</tr>
<tr>
<td>RegMean++</td>
<td>77.2</td>
<td>89.6</td>
<td>92.8</td>
<td>97.5</td>
<td>96.9</td>
<td>96.3</td>
<td>99.2</td>
<td>78.4</td>
<td>91.0</td>
</tr>
<tr>
<td>Task Arithmetic (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>72.0</td>
<td>79.0</td>
<td>80.5</td>
<td>86.0</td>
<td>87.5</td>
<td>83.5</td>
<td>98.0</td>
<td>58.8</td>
<td>80.7</td>
</tr>
<tr>
<td>Ties-Merging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>74.7</td>
<td>83.3</td>
<td>86.4</td>
<td>91.3</td>
<td>89.7</td>
<td>85.2</td>
<td>97.8</td>
<td>63.9</td>
<td>84.0</td>
</tr>
<tr>
<td>Task-wise AdaMerging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>75.8</td>
<td>80.1</td>
<td>77.2</td>
<td>83.6</td>
<td>68.4</td>
<td>93.5</td>
<td>93.1</td>
<td>69.0</td>
<td>80.1</td>
</tr>
<tr>
<td>Layer-wise AdaMerging (<span class="arithmatex">\(\lambda=0.3\)</span>)</td>
<td>78.1</td>
<td>90.7</td>
<td>90.8</td>
<td>96.5</td>
<td>94.8</td>
<td>97.5</td>
<td>98.6</td>
<td>81.3</td>
<td>91.0</td>
</tr>
<tr>
<td>Model Mixing</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Efficient Weight-Ensembling MoE (<span class="arithmatex">\(90\%\)</span>)</td>
<td>81.5</td>
<td>92.0</td>
<td>96.0</td>
<td>97.8</td>
<td>97.7</td>
<td>99.1</td>
<td>99.5</td>
<td>84.1</td>
<td>93.5</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>81.5</td>
<td>92.3</td>
<td>96.5</td>
<td>98.8</td>
<td>97.6</td>
<td>99.4</td>
<td>99.6</td>
<td>84.5</td>
<td>93.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h2 id="scope">Scope<a class="headerlink" href="#scope" title="Permanent link">&para;</a></h2>
<h3 id="task-vector-cosine-similarity">Task Vector Cosine Similarity<a class="headerlink" href="#task-vector-cosine-similarity" title="Permanent link">&para;</a></h3>
<p>Compute the cosine similarities between the task vectors and save the results to a CSV file.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c1"># CLIP-ViT-B/32 models</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>task_vector_cos_similarity<span class="w"> </span><span class="se">\</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">    </span>method.save_to_csv<span class="o">=</span><span class="s1">&#39;outputs/clip-vit-base-patch32_cos.csv&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">  </span><span class="nv">taskpool</span><span class="o">=</span>dummy<span class="w">  </span><span class="c1"># do not evaluate the model</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="c1"># CLIP-ViT-L/14 models</span>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="w">  </span><span class="nv">method</span><span class="o">=</span>task_vector_cos_similarity<span class="w"> </span><span class="se">\</span>
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="w">    </span>method.save_to_csv<span class="o">=</span><span class="s1">&#39;outputs/clip-vit-large-patch14_cos.csv&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="w">  </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_TA8<span class="w"> </span><span class="se">\</span>
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="w">  </span><span class="nv">tsakpool</span><span class="o">=</span>dummy
</span></code></pre></div>
<figure>
  <img alt="alt text" src="../clip-vit-cos.png" />
<br />
<figcaption>Cosine similarity matrices of task vectors for CLIP-ViT-B/32 and CLIP-ViT-L/14 models.</figcaption>
</figure>
<h3 id="generalization-and-robustness-evaluation">Generalization and Robustness Evaluation<a class="headerlink" href="#generalization-and-robustness-evaluation" title="Permanent link">&para;</a></h3>
<p>You can also evaluate the generalization and robustness of different multi-task model fusion methods by change the configurations.</p>
<p>Instruction for running the generalization experiments:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w">    </span><span class="nv">method</span><span class="o">=</span>...<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">    </span><span class="nv">modelpool</span><span class="o">=</span>CLIPVisionModelPool/clip-vit-base-patch32_generalization_exp1<span class="w"> </span><span class="c1"># or `clip-vit-base-patch32_generalization_exp2`</span>
</span></code></pre></div>
<p>Instruction for running the robustness experiments:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c1"># corription can be one of the following values: </span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="c1"># contrast, gaussian_noise, impulse_noise, jpeg_compression, motion_blur, pixelate, spatter</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="c1"># or pass `taskpool=clip-vit-base-patch32_robustness_clean` to evaluate the model on clean data</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="nv">corruption</span><span class="o">=</span>contrast
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>fusion_bench<span class="w"> </span><span class="se">\</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">    </span>--config-name<span class="w"> </span>clip-vit-base-patch32_robustness_corrupted<span class="w"> </span><span class="se">\</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="w">    </span><span class="nv">corruption</span><span class="o">=</span><span class="si">${</span><span class="nv">corruption</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">    </span><span class="nv">method</span><span class="o">=</span>...<span class="w"> </span><span class="se">\</span>
</span></code></pre></div>
<p>Below is an example of different types of corruptions:</p>
<figure>
<img alt="alt text" src="../images/clip_eight_corruption.png" width="800px" />

<figcaption style="max-width:90%">
An example of corruption data visualization, in which the corruption image generation method refers to Hendrycks &amp; Dietterich (2019) <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.
</figcaption>
</figure>
<h3 id="experimental-results_1">Experimental Results<a class="headerlink" href="#experimental-results_1" title="Permanent link">&para;</a></h3>
<div class="admonition info">
<p class="admonition-title">Hyperparameters not fully optimized</p>
<p>The hyperparameters used in these merging methods are not fully optimized and should be considered as preliminary results only. We welcome any discoveries of more effective parameters and would be grateful for your contributions to help us improve our results.</p>
<p>Please note that some model merging paper results were obtained using <a href="https://github.com/mlfoundations/task_vectors">OpenCLIP models</a>, which may show discrepancies with the results presented here. In such cases, the results reported in the original papers should be considered authoritative.</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Table: Results of the generalization experiments (Exp1).</label><label for="__tabbed_5_2">Table: Results of the generalization experiments (Exp2).</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th></th>
<th>Seen Tasks</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th>Unseen Tasks</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Method</td>
<td>SUN397</td>
<td>Cars</td>
<td>RESISC45</td>
<td>DTD</td>
<td>SVHN</td>
<td>GTSRB</td>
<td>Avg.</td>
<td>MNIST</td>
<td>EuroSAT</td>
<td>Avg.</td>
</tr>
<tr>
<td>Pre-trained</td>
<td>63.2</td>
<td>59.9</td>
<td>60.6</td>
<td>43.9</td>
<td>23.5</td>
<td>30.4</td>
<td>46.9</td>
<td>47.6</td>
<td>45.6</td>
<td>46.6</td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>65.5</td>
<td>67.2</td>
<td>78.2</td>
<td>57.6</td>
<td>84.2</td>
<td>75.9</td>
<td>71.4</td>
<td>71.8</td>
<td>49.4</td>
<td>60.6</td>
</tr>
<tr>
<td>RegMean</td>
<td>69.5</td>
<td>70.8</td>
<td>88.7</td>
<td>67.2</td>
<td>95.2</td>
<td>89.4</td>
<td>80.1</td>
<td>82.9</td>
<td>44.6</td>
<td>63.8</td>
</tr>
<tr>
<td>RegMean++</td>
<td>69.8</td>
<td>70.8</td>
<td>90.2</td>
<td>70.3</td>
<td>95.5</td>
<td>93.2</td>
<td>81.6</td>
<td>81.3</td>
<td>44.1</td>
<td>62.7</td>
</tr>
<tr>
<td>Task Arithmetic</td>
<td>64.3</td>
<td>63.0</td>
<td>73.2</td>
<td>54.9</td>
<td>84.7</td>
<td>79.5</td>
<td>69.9</td>
<td>75.5</td>
<td>42.6</td>
<td>59.1</td>
</tr>
<tr>
<td>Ties-Merging</td>
<td>68.3</td>
<td>65.5</td>
<td>76.9</td>
<td>54.9</td>
<td>75.4</td>
<td>72.0</td>
<td>68.9</td>
<td>73.1</td>
<td>47.3</td>
<td>60.2</td>
</tr>
<tr>
<td>Layer-wise AdaMerging</td>
<td>68.4</td>
<td>71.9</td>
<td>87.9</td>
<td>69.1</td>
<td>92.2</td>
<td>93.8</td>
<td>80.5</td>
<td>77.7</td>
<td>47.3</td>
<td>62.5</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>75.4</td>
<td>77.5</td>
<td>94.3</td>
<td>77.0</td>
<td>96.8</td>
<td>98.7</td>
<td>86.6</td>
<td>78.3</td>
<td>44.0</td>
<td>61.1</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th></th>
<th>Seen Tasks</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th>Unseen Tasks</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Method</td>
<td>SUN397</td>
<td>Cars</td>
<td>GTSRB</td>
<td>EuroSAT</td>
<td>DTD</td>
<td>MNIST</td>
<td>Avg.</td>
<td>RESISC45</td>
<td>SVHN</td>
<td>Avg.</td>
</tr>
<tr>
<td>Pre-trained</td>
<td>63.2</td>
<td>59.9</td>
<td>30.4</td>
<td>45.6</td>
<td>43.9</td>
<td>47.6</td>
<td>48.4</td>
<td>60.6</td>
<td>23.5</td>
<td>40.1</td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>68.1</td>
<td>67.4</td>
<td>67.2</td>
<td>86.4</td>
<td>58.6</td>
<td>81.6</td>
<td>71.5</td>
<td>60.2</td>
<td>42.5</td>
<td>51.3</td>
</tr>
<tr>
<td>RegMean</td>
<td>70.4</td>
<td>71.9</td>
<td>89.3</td>
<td>97.6</td>
<td>69.8</td>
<td>98.8</td>
<td>83.0</td>
<td>49.4</td>
<td>49.0</td>
<td>49.2</td>
</tr>
<tr>
<td>RegMean++</td>
<td>70.6</td>
<td>71.4</td>
<td>94.2</td>
<td>96.8</td>
<td>70.5</td>
<td>99.2</td>
<td>83.8</td>
<td>50.8</td>
<td>54.8</td>
<td>52.8</td>
</tr>
<tr>
<td>Task Arithmetic</td>
<td>65.2</td>
<td>63.6</td>
<td>76.1</td>
<td>87.1</td>
<td>56.4</td>
<td>94.2</td>
<td>73.8</td>
<td>52.4</td>
<td>45.2</td>
<td>48.8</td>
</tr>
<tr>
<td>Ties-Merging</td>
<td>68.2</td>
<td>65.9</td>
<td>70.0</td>
<td>81.2</td>
<td>56.0</td>
<td>89.0</td>
<td>71.7</td>
<td>60.3</td>
<td>47.3</td>
<td>53.8</td>
</tr>
<tr>
<td>Layer-wise AdaMerging</td>
<td>69.8</td>
<td>72.4</td>
<td>95.5</td>
<td>95.1</td>
<td>70.7</td>
<td>98.1</td>
<td>83.6</td>
<td>48.7</td>
<td>60.7</td>
<td>54.7</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>74.3</td>
<td>78.1</td>
<td>98.8</td>
<td>98.7</td>
<td>75.1</td>
<td>99.5</td>
<td>87.4</td>
<td>47.3</td>
<td>51.3</td>
<td>49.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Table: Results of the robustness experiments (<span class="arithmatex">\(\lambda=0.3\)</span>).</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Cars</th>
<th>EuroSAT</th>
<th>RESISC45</th>
<th>GTSRB</th>
<th>Avg.</th>
<th>Cars</th>
<th>EuroSAT</th>
<th>RESISC45</th>
<th>GTSRB</th>
<th>Avg.</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>Clean Test set</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Motion Blur</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>66.0</td>
<td>92.7</td>
<td>83.7</td>
<td>78.7</td>
<td>80.3</td>
<td>60.7</td>
<td>57.6</td>
<td>81.7</td>
<td>78.4</td>
<td>69.6</td>
</tr>
<tr>
<td>RegMean</td>
<td>73.1</td>
<td>97.2</td>
<td>91.2</td>
<td>95.1</td>
<td>89.1</td>
<td>70.8</td>
<td>71.3</td>
<td>88.7</td>
<td>87.9</td>
<td>79.7</td>
</tr>
<tr>
<td>RegMean++</td>
<td>73.7</td>
<td>96.7</td>
<td>91.9</td>
<td>96.6</td>
<td>89.7</td>
<td>72.6</td>
<td>71.2</td>
<td>89.9</td>
<td>93.6</td>
<td>81.8</td>
</tr>
<tr>
<td>Task Arithmetic</td>
<td>64.6</td>
<td>91.8</td>
<td>80.2</td>
<td>74.8</td>
<td>77.9</td>
<td>62.4</td>
<td>59.2</td>
<td>78.5</td>
<td>63.3</td>
<td>65.9</td>
</tr>
<tr>
<td>Ties-Merging</td>
<td>65.2</td>
<td>83.3</td>
<td>78.1</td>
<td>67.4</td>
<td>73.5</td>
<td>64.4</td>
<td>53.9</td>
<td>76.4</td>
<td>57.1</td>
<td>62.9</td>
</tr>
<tr>
<td>Layer-wise AdaMerging</td>
<td>75.2</td>
<td>94.3</td>
<td>87.6</td>
<td>96.7</td>
<td>88.5</td>
<td>72.4</td>
<td>72.7</td>
<td>85.3</td>
<td>94.3</td>
<td>81.2</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>77.4</td>
<td>98.9</td>
<td>94.4</td>
<td>99.0</td>
<td>92.4</td>
<td>76.5</td>
<td>74.2</td>
<td>93.7</td>
<td>97.4</td>
<td>85.5</td>
</tr>
<tr>
<td></td>
<td>Impulse Noise</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Gaussian Noise</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>61.5</td>
<td>50.0</td>
<td>74.7</td>
<td>52.6</td>
<td>59.7</td>
<td>61.6</td>
<td>48.1</td>
<td>76.0</td>
<td>51.3</td>
<td>59.3</td>
</tr>
<tr>
<td>RegMean</td>
<td>68.1</td>
<td>54.2</td>
<td>85.1</td>
<td>69.2</td>
<td>69.1</td>
<td>69.6</td>
<td>42.8</td>
<td>87.1</td>
<td>69.8</td>
<td>67.3</td>
</tr>
<tr>
<td>RegMean++</td>
<td>69.3</td>
<td>48.6</td>
<td>85.8</td>
<td>76.2</td>
<td>70.0</td>
<td>71.4</td>
<td>39.9</td>
<td>88.2</td>
<td>74.2</td>
<td>68.4</td>
</tr>
<tr>
<td>Task Arithmetic</td>
<td>59.8</td>
<td>53.3</td>
<td>72.3</td>
<td>45.0</td>
<td>57.6</td>
<td>61.5</td>
<td>52.5</td>
<td>75.0</td>
<td>50.1</td>
<td>59.8</td>
</tr>
<tr>
<td>Ties-Merging</td>
<td>60.2</td>
<td>45.6</td>
<td>69.8</td>
<td>38.3</td>
<td>53.5</td>
<td>61.8</td>
<td>47.3</td>
<td>73.1</td>
<td>42.3</td>
<td>56.1</td>
</tr>
<tr>
<td>Layer-wise AdaMerging</td>
<td>69.2</td>
<td>40.0</td>
<td>79.6</td>
<td>83.3</td>
<td>68.0</td>
<td>70.0</td>
<td>53.3</td>
<td>82.1</td>
<td>80.0</td>
<td>71.4</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>75.1</td>
<td>9.7</td>
<td>91.5</td>
<td>91.8</td>
<td>67.0</td>
<td>76.5</td>
<td>9.6</td>
<td>92.7</td>
<td>88.7</td>
<td>66.8</td>
</tr>
<tr>
<td></td>
<td>Pixelate</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Spatter</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>2.2</td>
<td>34.0</td>
<td>17.0</td>
<td>63.2</td>
<td>29.1</td>
<td>61.4</td>
<td>64.2</td>
<td>74.6</td>
<td>47.3</td>
<td>61.9</td>
</tr>
<tr>
<td>RegMean</td>
<td>2.3</td>
<td>38.1</td>
<td>17.1</td>
<td>90.9</td>
<td>37.1</td>
<td>68.5</td>
<td>64.0</td>
<td>84.6</td>
<td>83.9</td>
<td>75.2</td>
</tr>
<tr>
<td>RegMean++</td>
<td>2.2</td>
<td>37.9</td>
<td>17.2</td>
<td>94.2</td>
<td>37.9</td>
<td>69.7</td>
<td>60.3</td>
<td>84.2</td>
<td>89.3</td>
<td>75.9</td>
</tr>
<tr>
<td>Task Arithmetic</td>
<td>2.3</td>
<td>33.2</td>
<td>19.1</td>
<td>65.6</td>
<td>30.0</td>
<td>61.0</td>
<td>62.5</td>
<td>72.8</td>
<td>57.0</td>
<td>63.3</td>
</tr>
<tr>
<td>Ties-Merging</td>
<td>3.3</td>
<td>31.8</td>
<td>18.0</td>
<td>58.5</td>
<td>27.9</td>
<td>61.3</td>
<td>52.9</td>
<td>70.3</td>
<td>48.1</td>
<td>58.2</td>
</tr>
<tr>
<td>Layer-wise AdaMerging</td>
<td>1.3</td>
<td>52.9</td>
<td>21.0</td>
<td>91.0</td>
<td>41.5</td>
<td>68.4</td>
<td>55.9</td>
<td>78.3</td>
<td>92.3</td>
<td>73.7</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>0.5</td>
<td>11.6</td>
<td>2.3</td>
<td>97.5</td>
<td>28.0</td>
<td>75.1</td>
<td>9.7</td>
<td>91.4</td>
<td>96.3</td>
<td>68.1</td>
</tr>
<tr>
<td></td>
<td>Contrast</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>JPEG Compression</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Fisher Merging</td>
<td>63.8</td>
<td>58.4</td>
<td>75.5</td>
<td>70.4</td>
<td>67.0</td>
<td>66.3</td>
<td>67.6</td>
<td>82.6</td>
<td>58.9</td>
<td>68.8</td>
</tr>
<tr>
<td>RegMean</td>
<td>70.7</td>
<td>62.9</td>
<td>87.1</td>
<td>91.5</td>
<td>78.0</td>
<td>72.4</td>
<td>76.6</td>
<td>91.1</td>
<td>83.4</td>
<td>80.9</td>
</tr>
<tr>
<td>RegMean++</td>
<td>72.1</td>
<td>63.0</td>
<td>87.7</td>
<td>95.5</td>
<td>79.6</td>
<td>73.5</td>
<td>76.3</td>
<td>91.8</td>
<td>89.6</td>
<td>82.8</td>
</tr>
<tr>
<td>Task Arithmetic</td>
<td>62.3</td>
<td>55.7</td>
<td>75.3</td>
<td>70.8</td>
<td>66.0</td>
<td>63.9</td>
<td>66.1</td>
<td>80.1</td>
<td>61.0</td>
<td>67.8</td>
</tr>
<tr>
<td>Ties-Merging</td>
<td>64.2</td>
<td>52.4</td>
<td>74.8</td>
<td>63.5</td>
<td>63.7</td>
<td>65.0</td>
<td>59.5</td>
<td>77.9</td>
<td>53.2</td>
<td>63.9</td>
</tr>
<tr>
<td>Layer-wise AdaMerging</td>
<td>73.1</td>
<td>67.4</td>
<td>83.0</td>
<td>96.2</td>
<td>79.9</td>
<td>72.9</td>
<td>70.7</td>
<td>86.3</td>
<td>90.6</td>
<td>80.1</td>
</tr>
<tr>
<td>Weight-Ensembling MoE</td>
<td>77.2</td>
<td>34.7</td>
<td>93.1</td>
<td>98.4</td>
<td>75.9</td>
<td>77.3</td>
<td>61.0</td>
<td>94.1</td>
<td>95.7</td>
<td>82.0</td>
</tr>
</tbody>
</table>
<h2 id="implementation-details">Implementation Details<a class="headerlink" href="#implementation-details" title="Permanent link">&para;</a></h2>
<ul>
<li><a class="autorefs autorefs-internal" title="            CLIPVisionModelPool" href="../../api/fusion_bench.modelpool/#fusion_bench.modelpool.CLIPVisionModelPool">fusion_bench.modelpool.clip_vision.CLIPVisionModelPool</a></li>
</ul>
<h3 id="model-configuration-schema">Model Configuration Schema<a class="headerlink" href="#model-configuration-schema" title="Permanent link">&para;</a></h3>
<p>The CLIPVisionModelPool supports flexible model configurations:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="c1"># Simple string configuration</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>    <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;huggingface/model-id&quot;</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="p">}</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="c1"># Advanced configuration with custom parameters</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>    <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>        <span class="s2">&quot;_target_&quot;</span><span class="p">:</span> <span class="s2">&quot;transformers.CLIPVisionModel.from_pretrained&quot;</span><span class="p">,</span>
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>        <span class="s2">&quot;pretrained_model_name_or_path&quot;</span><span class="p">:</span> <span class="s2">&quot;huggingface/model-id&quot;</span><span class="p">,</span>
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a>        <span class="s2">&quot;torch_dtype&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>        <span class="s2">&quot;device_map&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span>
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>    <span class="p">}</span>
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a><span class="p">}</span>
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a><span class="c1"># Mixed configuration</span>
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a><span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a>    <span class="s2">&quot;_pretrained_&quot;</span><span class="p">:</span> <span class="s2">&quot;openai/clip-vit-base-patch32&quot;</span><span class="p">,</span>
</span><span id="__span-44-19"><a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a>    <span class="s2">&quot;sun397&quot;</span><span class="p">:</span> <span class="s2">&quot;tanganke/clip-vit-base-patch32_sun397&quot;</span><span class="p">,</span>
</span><span id="__span-44-20"><a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a>    <span class="s2">&quot;custom_model&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-44-21"><a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a>        <span class="s2">&quot;_target_&quot;</span><span class="p">:</span> <span class="s2">&quot;some.custom.loader&quot;</span><span class="p">,</span>
</span><span id="__span-44-22"><a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a>        <span class="s2">&quot;custom_param&quot;</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span>
</span><span id="__span-44-23"><a id="__codelineno-44-23" name="__codelineno-44-23" href="#__codelineno-44-23"></a>    <span class="p">}</span>
</span><span id="__span-44-24"><a id="__codelineno-44-24" name="__codelineno-44-24" href="#__codelineno-44-24"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="platform-support">Platform Support<a class="headerlink" href="#platform-support" title="Permanent link">&para;</a></h3>
<p>The modelpool supports multiple platforms for model and dataset loading:</p>
<ul>
<li><strong>Hugging Face Hub</strong> (<code>platform="hf"</code>): Default platform for loading models and datasets</li>
<li><strong>ModelScope</strong> (<code>platform="modelscope"</code>): Alternative platform popular in China</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="c1"># Hugging Face platform (default, platform=&quot;hf&quot; or &quot;huggingface&quot;)</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">platform</span><span class="o">=</span><span class="s2">&quot;hf&quot;</span><span class="p">)</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="c1"># ModelScope platform</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="n">modelpool</span> <span class="o">=</span> <span class="n">CLIPVisionModelPool</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">platform</span><span class="o">=</span><span class="s2">&quot;modelscope&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Dan Hendrycks and Thomas Dietterich. Benchmarking neural network robustness to common corruptions and perturbations. Proceedings of the International Conference on Learning Representations, 2019.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Model Pool Module">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Model Pool Module
              </div>
            </div>
          </a>
        
        
          
          <a href="../nyuv2/" class="md-footer__link md-footer__link--next" aria-label="Next: ResNet Models for Sence Understanding">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                ResNet Models for Sence Understanding
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/tanganke/fusion_bench" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/fusion-bench" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["toc.follow", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "navigation.top", "navigation.tabs", "navigation.footer", "navigation.expand", "navigation.indexes", "navigation.sections", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/polyfill.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>